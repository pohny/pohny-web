(function e$$0(p,l,a){function b(c,g){if(!l[c]){if(!p[c]){var m="function"==typeof require&&require;if(!g&&m)return m(c,!0);if(d)return d(c,!0);m=Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m;}m=l[c]={exports:{}};p[c][0].call(m.exports,function(a){var e=p[c][1][a];return b(e?e:a)},m,m.exports,e$$0,p,l,a)}return l[c].exports}for(var d="function"==typeof require&&require,c=0;c<a.length;c++)b(a[c]);return b})({1:[function(h,p,l){Twilio=function(a){var b=a||function(){};(function(a){for(var c in a)b[c]=
a[c]})(function(){var a=h("./twilio/util"),c;if("undefined"==typeof c){c=location.protocol||"http:";for(var b="//media.twiliocdn.com/sdk/js/client/",g=document.getElementsByTagName("script"),m=RegExp("(\\w+:)?(//.*)v"+a.getPStreamVersion()+"/(twilio.min.js|twilio.js)"),k=0;k<g.length;k++){var e=g[k].src.match(m);if(e){c=e[1]||c;b=e[2];break}}c+=b}a.setTwilioRoot(c);return h("./twilio")}());return b}("undefined"!==typeof Twilio?Twilio:null)},{"./twilio":2,"./twilio/util":19}],2:[function(h,p,l){l.Device=
h("./twilio/device").Device;l.PStream=h("./twilio/pstream").PStream;l.Connection=h("./twilio/connection").Connection},{"./twilio/connection":3,"./twilio/device":4,"./twilio/pstream":9}],3:[function(h,p,l){function a(n,A,z){function d(){}function h(){0!==C.length&&(10===C.length&&v.enableWarnings(),q.postMetrics("quality-metrics-samples","metrics-sample",C.splice(0),{call_sid:t.parameters.CallSid}))}function l(q){var a={threshold:q.threshold.value};q.values?a.values=q.values.map(function(q){return"number"===
typeof q?Math.round(100*q)/100:q}):q.value&&(a.value=q.value);return{data:a}}function w(a,c){var A=(/^audio/.test(c.name)?"audio-level-":"network-quality-")+"warning"+(a?"-cleared":"-raised"),n=u[c.threshold.name]+e[c.name];"constant-audio-input-level"===n&&t.isMuted()||q.post(a?"info":"warning",A,n,l(c))}if(!(this instanceof a))return new a(n,A,z);k.monitorEventEmitter("Twilio.Connection",this);this.device=n;this.message=A||{};z=z||{};A={logPrefix:"[Connection]",mediaStreamFactory:g.PeerConnection,
offerSdp:null,callParameters:{},debug:!1,encrypt:!1,audioConstraints:n.options.audioConstraints,rtcConstraints:n.options.rtcConstraints,iceServers:n.options.iceServers};for(var r in A)r in z||(z[r]=A[r]);this.options=z;this.parameters=z.callParameters;this._status=this.options.offerSdp?"pending":"closed";this._direction=this.parameters.CallSid?"INCOMING":"OUTGOING";this.sendHangup=!0;c.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;this.log.warnings=this.options.warnings;
this._onHangup=this._onCancel=d;this._onAnswer=function(q){"undefined"!==typeof q.callsid&&(t.parameters.CallSid=q.callsid,t.mediaStream.callSid=q.callsid)};var t=this,q=this._publisher=new f("twilio-js-sdk",n.token,{host:n.options.eventgw,defaultPayload:function(){var q={client_name:n._clientName,platform:g.getMediaEngine(),sdk_version:k.getReleaseVersion(),selected_region:n.options.region};t.parameters.CallSid&&!/^TJ/.test(t.parameters.CallSid)&&(q.call_sid=t.parameters.CallSid);t.outboundConnectionId&&
(q.temp_call_sid=t.outboundConnectionId);n.stream&&(n.stream.gateway&&(q.gateway=n.stream.gateway),n.stream.region&&(q.region=n.stream.region));t._direction&&(q.direction=t._direction);return q}});!1===z.publishEvents&&q.disable();"INCOMING"===this._direction&&q.info("connection","incoming");var v=this._monitor=new m;v.disableWarnings();var C=[];v.on("sample",function(q){C.push(q);10<=C.length&&h()});v.on("warning-cleared",w.bind(null,!0));v.on("warning",w.bind(null,!1));this.mediaStream=new this.options.mediaStreamFactory(this.options.encrypt,
this.device);this.mediaStream.oniceconnectionstatechange=function(a){q.post("failed"===a?"error":"debug","ice-connection-state",a)};this.mediaStream.onicegatheringstatechange=function(a){q.debug("signaling-state",a)};this.mediaStream.onsignalingstatechange=function(a){q.debug("signaling-state",a)};this.mediaStream.onerror=function(q){!0===q.disconnect&&t._disconnect(q.info&&q.info.message);var a={code:q.info.code,message:q.info.message||"Error with mediastream",info:q.info,connection:t};t.log("Received an error from MediaStream:",
q);t.emit("error",a)};this.mediaStream.onopen=function(){"open"!==t._status&&("connecting"===t._status?(t._status="open",t.mediaStream.attachAudio(),t.emit("accept",t)):t.mediaStream.close())};this.mediaStream.onclose=function(){t._status="closed";t.device.sounds.disconnect()&&t.device.soundcache.play("disconnect");v.disable();h();t.emit("disconnect",t)};this.outboundConnectionId=k.generateConnectionUUID();this.pstream=this.device.stream;this._onCancel=function(q){t.parameters.CallSid==q.callsid&&
(t.ignore(),t.pstream.removeListener("cancel",t._onCancel))};this.pstream&&this.pstream.addListener("cancel",this._onCancel);this.on("error",function(a){q.error("connection","error",{data:{code:a.code,message:a.message}});t.pstream&&"disconnected"===t.pstream.status&&b(t)});this.on("disconnect",function(){b(t)});return this}function b(a){function c(){a.pstream.removeListener("answer",a._onAnswer);a.pstream.removeListener("cancel",a._onCancel);a.pstream.removeListener("hangup",a._onHangup)}c();setTimeout(c,
0)}p=h("events").EventEmitter;var d=h("./util").Exception,c=h("./log"),f=h("./eventpublisher"),g=h("./rtc"),m=h("./rtc/monitor"),k=h("./util"),e={audioOutputLevel:"audio-output-level",audioInputLevel:"audio-input-level",packetsLostFraction:"packet-loss",jitter:"jitter",rtt:"rtt",mos:"mos"},u={min:"low-",max:"high-",maxDuration:"constant-"};h("util").inherits(a,p);a.toString=function(){return"[Twilio.Connection class]"};a.prototype.toString=function(){return"[Twilio.Connection instance]"};a.prototype.sendDigits=
function(a){if(a.match(/[^0-9*#w]/))throw new d("Illegal character passed into sendDigits");for(var c=[],b=0;b<a.length;b++){var e="w"!=a[b]?"dtmf"+a[b]:"";"dtmf*"==e&&(e="dtmfs");"dtmf#"==e&&(e="dtmfh");c.push([e,200,20])}this.device.soundcache.playseq(c);var f=this.mediaStream.getOrCreateDTMFSender();if(f){if(f.canInsertDTMF){var k=function(){var a=g.shift();a.length&&f.insertDTMF(a,160,70);g.length&&setTimeout(k,500)};this.log("Sending digits using RTCDTMFSender");var g=a.split("w");g.length&&
k();return}this.log("RTCDTMFSender cannot insert DTMF")}this.log("Sending digits over PStream");null!=this.pstream&&"disconnected"!=this.pstream.status?(a={dtmf:a,callsid:this.parameters.CallSid},this.pstream.publish("dtmf",a)):(a={error:{}},this.emit("error",{code:a.error.code||31E3,message:a.error.message||"Could not send DTMF: Signaling channel is disconnected",connection:this}))};a.prototype.status=function(){return this._status};a.prototype.mute=function(a){0===arguments.length&&this.log.deprecated(".mute() is deprecated. Please use .mute(true) or .mute(false) to mute or unmute a call instead.");
if("function"==typeof a)return this.addListener("mute",a);var c=this.isMuted(),b=this,e=function(){var a=b.isMuted();c!=a&&(b._publisher.info("connection",a?"muted":"unmuted"),b.emit("mute",a,b))};0==a?this.mediaStream.attachAudio(e):this.mediaStream.detachAudio(e)};a.prototype.isMuted=function(){return!this.mediaStream.isAudioAttached()};a.prototype.unmute=function(){this.log.deprecated(".unmute() is deprecated. Please use .mute(false) to unmute a call instead.");this.mute(!1)};a.prototype.accept=
function(a){if("function"==typeof a)return this.addListener("accept",a);var c=a||this.options.audioConstraints,e=this;this._status="connecting";this.mediaStream.openHelper(function(a){function n(a){e._publisher.info("connection","accepted-by-local");e._monitor.enable(a)}function f(a){e._publisher.info("connection","accepted-by-remote");e._monitor.enable(a)}if("connecting"!=e._status)b(e),e.mediaStream.close();else{if(a)return 31208===a.code?e._publisher.error("get-user-media","denied",{data:{audioConstraints:c,
error:a.error}}):e._publisher.error("get-user-media","failed",{data:{audioConstraints:c,error:a.error}}),e._die(a.message,a.code);e._publisher.info("get-user-media","succeeded",{data:{audioConstraints:c}});a=[];for(var d in e.message)a.push(encodeURIComponent(d)+"="+encodeURIComponent(e.message[d]));d=a.join("&");"INCOMING"===e._direction?e.mediaStream.answerIncomingCall.call(e.mediaStream,e.parameters.CallSid,e.options.offerSdp,e.options.rtcConstraints,e.options.iceServers,n):(e.pstream.once("answer",
e._onAnswer),e.mediaStream.makeOutgoingCall.call(e.mediaStream,d,e.outboundConnectionId,e.options.rtcConstraints,e.options.iceServers,f));e._onHangup=function(a){if(a.callsid&&(e.parameters.CallSid||e.outboundConnectionId)){if(a.callsid!=e.parameters.CallSid&&a.callsid!=e.outboundConnectionId)return}else if(a.callsid)return;e.log("Received HANGUP from gateway");a.error&&(a={code:a.error.code||31E3,message:a.error.message||"Error sent from gateway in HANGUP",connection:e},e.log("Received an error from the gateway:",
a),e.emit("error",a));e.sendHangup=!1;e._publisher.info("connection","disconnected-by-remote");e._disconnect();b(e)};e.pstream.addListener("hangup",e._onHangup)}},c)};a.prototype.reject=function(a){if("function"==typeof a)return this.addListener("reject",a);"pending"==this._status&&(this.pstream.publish("reject",{callsid:this.parameters.CallSid}),this.emit("reject"),this.mediaStream.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local"))};a.prototype.ignore=function(a){if("function"==
typeof a)return this.addListener("cancel",a);"pending"==this._status&&(this._status="closed",this.emit("cancel"),this.mediaStream.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local"))};a.prototype.cancel=function(a){this.log.deprecated(".cancel() is deprecated. Please use .ignore() instead.");this.ignore(a)};a.prototype.disconnect=function(a){if("function"===typeof a)return this.addListener("disconnect",a);this._publisher.info("connection","disconnected-by-local");
this._disconnect()};a.prototype._disconnect=function(a){a="string"===typeof a?a:null;if("open"==this._status||"connecting"==this._status){this.log("Disconnecting...");if(null!=this.pstream&&"disconnected"!=this.pstream.status&&this.sendHangup){var e=this.parameters.CallSid||this.outboundConnectionId;e&&(e={callsid:e},a&&(e.message=a),this.pstream.publish("hangup",e))}b(this);this.mediaStream.close()}};a.prototype.error=function(a){if("function"==typeof a)return this.addListener("error",a)};a.prototype._die=
function(a,e){this.emit("error",{message:a,code:e});this._disconnect()};l.Connection=a},{"./eventpublisher":5,"./log":7,"./rtc":11,"./rtc/monitor":12,"./util":19,events:23,util:42}],4:[function(h,p,l){function a(b,d){if(!g.enabled())throw new f.Exception("twilio.js 1.3 requires WebRTC/ORTC browser support. For more information, see <https://www.twilio.com/docs/api/client/twilio-js>. If you have any questions about this announcement, please contact Twilio Support at <help@twilio.com>.");if(!(this instanceof
a))return new a(b,d);f.monitorEventEmitter("Twilio.Device",this);if(!b)throw new f.Exception("Capability token is not valid or missing.");for(i in d);var x={logPrefix:"[Device]",chunderw:"chunderw-vpc-gll.twilio.com",eventgw:"eventgw.twilio.com",soundCacheFactory:e,soundFactory:k,connectionFactory:u,pStreamFactory:n,noRegister:!1,encrypt:!1,closeProtection:!1,secureSignaling:!0,warnings:!0,audioConstraints:!0,iceServers:[],region:"gll",dscp:!0,sounds:{}};d=d||{};var h=d.chunderw,l;for(l in x)l in
d||(d[l]=x[l]);d.rtcConstraints=d.dscp?{optional:[{googDscp:!0}]}:{};x=f.objectize(b);this._accountSid=x.iss;this._clientName=x.scope["client:incoming"]?x.scope["client:incoming"].params.clientName:null;this.options=d;this.token=b;this._region=this._status="offline";this.connections=[];this.sounds=new m({incoming:!0,outgoing:!0,disconnect:!0});c.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;x={gll:"chunderw-vpc-gll.twilio.com",au1:"chunderw-vpc-gll-au1.twilio.com",br1:"chunderw-vpc-gll-br1.twilio.com",
ie1:"chunderw-vpc-gll-ie1.twilio.com",jp1:"chunderw-vpc-gll-jp1.twilio.com",sg1:"chunderw-vpc-gll-sg1.twilio.com",us1:"chunderw-vpc-gll-us1.twilio.com"};l={au:"au1",br:"br1",ie:"ie1",jp:"jp1",sg:"sg1","us-va":"us1","us-or":"us1"};var w=d.region.toLowerCase();w in l&&(this.log.deprecated("Region "+w+" is deprecated, please use "+l[w]+"."),w=l[w]);if(!(w in x))throw new f.Exception("Region "+d.region+" is invalid. Valid values are: "+Object.keys(x).join(", "));d.chunderw=h||x[w];this.soundcache=this.options.soundCacheFactory();
h="undefined"===typeof document?{}:document.createElement("audio");canPlayMp3=!1;try{canPlayMp3=!(!h.canPlayType||!h.canPlayType("audio/mpeg").replace(/no/,""))}catch(C){}canPlayVorbis=!1;try{canPlayVorbis=!(!h.canPlayType||!h.canPlayType('audio/ogg;codecs="vorbis"').replace(/no/,""))}catch(C){}h="mp3";canPlayVorbis&&!canPlayMp3&&(h="ogg");x={incoming:{filename:"incoming",loop:!0},outgoing:{filename:"outgoing",maxDuration:3E3},disconnect:{filename:"disconnect",maxDuration:3E3},dtmf1:{filename:"dtmf-1",
maxDuration:1E3},dtmf2:{filename:"dtmf-2",maxDuration:1E3},dtmf3:{filename:"dtmf-3",maxDuration:1E3},dtmf4:{filename:"dtmf-4",maxDuration:1E3},dtmf5:{filename:"dtmf-5",maxDuration:1E3},dtmf6:{filename:"dtmf-6",maxDuration:1E3},dtmf7:{filename:"dtmf-7",maxDuration:1E3},dtmf8:{filename:"dtmf-8",maxDuration:1E3},dtmf9:{filename:"dtmf-9",maxDuration:1E3},dtmf0:{filename:"dtmf-0",maxDuration:1E3},dtmfs:{filename:"dtmf-star",maxDuration:1E3},dtmfh:{filename:"dtmf-hash",maxDuration:1E3}};l=f.getTwilioRoot()+
"sounds/releases/"+f.getSoundVersion()+"/";for(var r in x){var w=x[r],t=this.options.soundFactory(w);t.load(l+w.filename+"."+h);this.soundcache.add(r,t)}this.soundcache.envelope("incoming",{release:2E3});var q=this;this.addListener("incoming",function(a){a.once("accept",function(){q.soundcache.stop("incoming")});a.once("cancel",function(){q.soundcache.stop("incoming")});a.once("error",function(){q.soundcache.stop("incoming")});a.once("reject",function(){q.soundcache.stop("incoming")});q.sounds.incoming()&&
q.soundcache.play("incoming",0,1E3)});this.mediaPresence={audio:!this.options.noRegister};this.register(this.token);var v=this.options.closeProtection;v&&(r=function(a){if("busy"==q._status){var e=1==v?"A call is currently in-progress. Leaving or reloading this page will end the call.":v;return(a||window.event).returnValue=e}},"undefined"!==typeof window&&(window.addEventListener?window.addEventListener("beforeunload",r):window.attachEvent&&window.attachEvent("onbeforeunload",r)));r=function(){q.disconnectAll()};
"undefined"!==typeof window&&(window.addEventListener?window.addEventListener("unload",r):window.attachEvent&&window.attachEvent("onunload",r));this.on("error",function(){});return this}function b(a,e,c){var b={publishEvents:a.options.publishEvents,debug:a.options.debug,encrypt:a.options.encrypt,warnings:a.options.warnings};c=c||{};for(var f in b)f in c||(c[f]=b[f]);var n=a.options.connectionFactory(a,e,c);n.once("accept",function(){a._status="busy";a.emit("connect",n)});n.addListener("error",function(e){a.emit("error",
e);"pending"==n.status()&&"connecting"==n.status()&&a._removeConnection(n)});n.once("cancel",function(){a.log("Canceled: "+n.parameters.CallSid);a._removeConnection(n);a.emit("cancel",n)});n.once("disconnect",function(){"busy"==a._status&&(a._status="ready");a.emit("disconnect",n);a._removeConnection(n)});n.once("reject",function(){a.log("Rejected: "+n.parameters.CallSid);a._removeConnection(n)});return n}p=h("events").EventEmitter;var d=h("util"),c=h("./log"),f=h("./util"),g=h("./rtc"),m=h("./options").Options,
k=h("./sound").Sound,e=h("./soundcache").SoundCache,u=h("./connection").Connection,n=h("./pstream").PStream;d.inherits(a,p);a.toString=function(){return"[Twilio.Device class]"};a.prototype.toString=function(){return"[Twilio.Device instance]"};a.prototype.register=function(a){this.stream&&"disconnected"!=this.stream.status?this.stream.setToken(a):this._setupStream()};a.prototype.registerPresence=function(){this.token&&(f.objectize(this.token).scope["client:incoming"]&&(this.mediaPresence.audio=!0),
this._sendPresence())};a.prototype.unregisterPresence=function(){this.mediaPresence.audio=!1;this._sendPresence()};a.prototype.connect=function(a,e){if("function"==typeof a)return this.addListener("connect",a);a=a||{};e=e||this.options.audioConstraints;var c=b(this,a);this.connections.push(c);if(this.sounds.outgoing()){var n=this;c.accept(function(){n.soundcache.play("outgoing")})}c.accept(e);return c};a.prototype.disconnectAll=function(){for(var a=[].concat(this.connections),e=0;e<a.length;e++)a[e].disconnect();
0<this.connections.length&&this.log("Connections left pending: "+this.connections.length)};a.prototype.destroy=function(){this._stopRegistrationTimer();this.stream&&(this.stream.destroy(),this.stream=null)};a.prototype.disconnect=function(a){this.addListener("disconnect",a)};a.prototype.incoming=function(a){this.addListener("incoming",a)};a.prototype.offline=function(a){this.addListener("offline",a)};a.prototype.ready=function(a){this.addListener("ready",a)};a.prototype.error=function(a){this.addListener("error",
a)};a.prototype.status=function(){return this._status};a.prototype.activeConnection=function(){return this.connections[0]};a.prototype.region=function(){return this._region};a.prototype._sendPresence=function(){this.stream.register(this.mediaPresence);this.mediaPresence.audio?this._startRegistrationTimer():this._stopRegistrationTimer()};a.prototype._startRegistrationTimer=function(){clearTimeout(this.regTimer);var a=this;this.regTimer=setTimeout(function(){a._sendPresence()},3E4)};a.prototype._stopRegistrationTimer=
function(){clearTimeout(this.regTimer)};a.prototype._setupStream=function(){var a=this;this.log("Setting up PStream");this.stream=this.options.pStreamFactory(this.token,{chunderw:this.options.chunderw,debug:this.options.debug,secureSignaling:this.options.secureSignaling});this.stream.addListener("connected",function(e){a._region={US_EAST_VIRGINIA:"us1",US_WEST_OREGON:"us2",ASIAPAC_SYDNEY:"au1",SOUTH_AMERICA_SAO_PAULO:"br1",EU_IRELAND:"ie1",ASIAPAC_TOKYO:"jp1",ASIAPAC_SINGAPORE:"sg1"}[e.region]||e.region;
a._sendPresence()});this.stream.addListener("ready",function(){a.log("Stream is ready");"offline"==a._status&&(a._status="ready");a.emit("ready",a)});this.stream.addListener("offline",function(){a.log("Stream is offline");a._status="offline";a._region="offline";a.emit("offline",a)});this.stream.addListener("error",function(e){var c=e.error;c&&(e.callsid&&(c.connection=a._findConnection(e.callsid)),31205===c.code&&a._stopRegistrationTimer(),a.log("Received error: ",c),a.emit("error",c))});this.stream.addListener("invite",
function(e){if("busy"==a._status)a.log("Device busy; ignoring incoming invite");else if(e.callsid&&e.sdp){var c=e.parameters||{};c.CallSid=c.CallSid||e.callsid;e=b(a,{},{offerSdp:e.sdp,callParameters:c});a.connections.push(e);a.emit("incoming",e)}else a.emit("error",{message:"Malformed invite from gateway"})})};a.prototype._removeConnection=function(a){for(var e=this.connections.length-1;0<=e;e--)a==this.connections[e]&&this.connections.splice(e,1)};a.prototype._findConnection=function(a){for(var e=
0;e<this.connections.length;e++){var c=this.connections[e];if(c.parameters.CallSid==a||c.outboundConnectionId==a)return c}};a=function(e){var c=[],b=[],n=function(a){if(e.instance)return a();b.push(a)},d=function(a){a=(a.code?a.code+": ":"")+a.message;if(e.instance){for(var q=0,c=e.instance.listeners("error"),b=0;b<c.length;b++)c[b]!==d&&q++;if(1<q)return;e.instance.log(a)}throw new f.Exception(a);},k={instance:null,setup:function(n,q){if(e.instance)e.instance.log("Found existing Device; using new token but ignoring options"),
e.instance.token=n,e.instance.register(n);else{e.instance=new a(n,q);e.error(d);e.sounds=e.instance.sounds;for(var v=0;v<b.length;v++)b[v]();b=[]}for(v=0;v<c.length;v++)c[v](n,q);c=[];return e},connect:function(a,q){if("function"==typeof a)n(function(){e.instance.addListener("connect",a)});else{if(!e.instance)throw new f.Exception("Run Twilio.Device.setup()");if(0<e.instance.connections.length)e.instance.emit("error",{message:"A connection is currently active"});else return e.instance.connect(a,q)}},
disconnectAll:function(){n(function(){e.instance.disconnectAll()});return e},disconnect:function(a){n(function(){e.instance.addListener("disconnect",a)});return e},status:function(){if(!e.instance)throw new f.Exception("Run Twilio.Device.setup()");return e.instance.status()},region:function(){if(!e.instance)throw new f.Exception("Run Twilio.Device.setup()");return e.instance.region()},ready:function(a){n(function(){e.instance.addListener("ready",a)});return e},error:function(a){n(function(){a!=d&&
e.instance.removeListener("error",d);e.instance.addListener("error",a)});return e},offline:function(a){n(function(){e.instance.addListener("offline",a)});return e},incoming:function(a){n(function(){e.instance.addListener("incoming",a)});return e},destroy:function(){e.instance&&e.instance.destroy();return e},cancel:function(a){n(function(){e.instance.addListener("cancel",a)});return e},activeConnection:function(){return e.instance?e.instance.activeConnection():null}},g;for(g in k)e[g]=k[g];return e}(a);
l.Device=a},{"./connection":3,"./log":7,"./options":8,"./pstream":9,"./rtc":11,"./sound":16,"./soundcache":17,"./util":19,events:23,util:42}],5:[function(h,p,l){function a(c,b,d){if(!(this instanceof a))return new a(c,b,d);d=Object.assign({defaultPayload:function(){return{}},host:"eventgw.twilio.com"},d);var m=d.defaultPayload;"function"!==typeof m&&(m=function(){return Object.assign({},d.defaultPayload)});var k=!0;Object.defineProperties(this,{_defaultPayload:{value:m},_isEnabled:{get:function(){return k},
set:function(a){k=a}},_host:{value:d.host},isEnabled:{enumerable:!0,get:function(){return k}},productName:{enumerable:!0,value:c},token:{enumerable:!0,value:b}})}function b(a){return{timestamp:(new Date(a.timestamp)).toISOString(),total_packets_received:a.totals.packetsReceived,total_packets_lost:a.totals.packetsLost,total_packets_sent:a.totals.packetsSent,total_bytes_received:a.totals.bytesReceived,total_bytes_sent:a.totals.bytesSent,packets_received:a.packetsReceived,packets_lost:a.packetsLost,
packets_lost_fraction:a.packetsLostFraction&&Math.round(100*a.packetsLostFraction)/100,audio_level_in:a.audioInputLevel,audio_level_out:a.audioOutputLevel,jitter:a.jitter,rtt:a.rtt,mos:a.mos&&Math.round(100*a.mos)/100}}var d=h("./request");a.prototype._post=function(a,b,g,m,k,e){if(!this.isEnabled&&!e)return Promise.resolve();b={publisher:this.productName,group:g,name:m,timestamp:(new Date).toISOString(),level:b.toUpperCase(),payload_type:"application/json","private":!1,payload:k&&k.forEach?k.slice(0):
Object.assign(this._defaultPayload(),k)};var u={url:"https://"+this._host+"/v2/"+a,body:b,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token}};return new Promise(function(a,e){d.post(u,function(c){c?e(c):a()})})};a.prototype.post=function(a,b,d,m,k){return this._post("EndpointEvents",a,b,d,m,k)};a.prototype.debug=function(a,b,d){return this.post("debug",a,b,d)};a.prototype.info=function(a,b,d){return this.post("info",a,b,d)};a.prototype.warn=function(a,b,d){return this.post("warning",
a,b,d)};a.prototype.error=function(a,b,d){return this.post("error",a,b,d)};a.prototype.postMetrics=function(a,d,g,m){g=g.map(b).map(function(a){return Object.assign(a,m)});return this._post("EndpointMetrics","info",a,d,g)};a.prototype.enable=function(){this._isEnabled=!0};a.prototype.disable=function(){this._isEnabled=!1};p.exports=a},{"./request":10}],6:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);b=b||{};var d=function(){},d={interval:10,now:function(){return(new Date).getTime()},
repeat:function(a,b){return setInterval(a,b)},stop:function(a,b){return clearInterval(a,b)},onsleep:d,onwakeup:d},c;for(c in d)c in b||(b[c]=d[c]);this.interval=b.interval;this.lastbeat=0;this.pintvl=null;this.onsleep=b.onsleep;this.onwakeup=b.onwakeup;this.repeat=b.repeat;this.stop=b.stop;this.now=b.now}a.toString=function(){return"[Twilio.Heartbeat class]"};a.prototype.toString=function(){return"[Twilio.Heartbeat instance]"};a.prototype.beat=function(){this.lastbeat=this.now();if(this.sleeping()){if(this.onwakeup)this.onwakeup();
var a=this;this.pintvl=this.repeat.call(null,function(){a.check()},1E3*this.interval)}};a.prototype.check=function(){var a=this.now()-this.lastbeat;if(!this.sleeping()&&a>=1E3*this.interval){if(this.onsleep)this.onsleep();this.stop.call(null,this.pintvl);this.pintvl=null}};a.prototype.sleeping=function(){return null==this.pintvl};l.Heartbeat=a},{}],7:[function(h,p,l){l.mixinLog=function(a,b){function d(){if(d.enabled)for(var a=d.prefix?d.prefix+" ":"",b=0;b<arguments.length;b++){var g=arguments[b];
d.handler("string"==typeof g?a+g:g)}}d.enabled=!0;d.prefix=b||"";d.defaultHandler=function(a){"undefined"!==typeof console&&console.log(a)};d.handler=d.defaultHandler;d.warnings=!0;d.defaultWarnHandler=function(a){"undefined"!==typeof console&&("function"===typeof console.warn?console.warn(a):"function"===typeof console.log&&console.log(a))};d.warnHandler=d.defaultWarnHandler;d.deprecated=function(){if(d.warnings)for(var a=0;a<arguments.length;a++)d.warnHandler(arguments[a])};a.log=d}},{}],8:[function(h,
p,l){h=function(){function a(d,c){if(!(this instanceof a))return new a(d);this.__dict__={};d=d||{};c=c||{};for(var f in d)this[f]=b(this.__dict__,f),this[f](d[f]);for(f in c)this[f](c[f])}function b(a,b){return function(f){return"undefined"==typeof f?a[b]:a[b]=f}}return a}();l.Options=h},{}],9:[function(h,p,l){function a(b,m){if(!(this instanceof a))return new a(b,m);c.monitorEventEmitter("Twilio.PStream",this);var k={logPrefix:"[PStream]",chunderw:"chunderw-vpc-gll.twilio.com",secureSignaling:!0,
transportFactory:f,debug:!1};m=m||{};for(var e in k)e in m||(m[e]=k[e]);this.options=m;this.token=b||"";this.status="disconnected";this.host=this.options.chunderw;this.region=this.gateway=null;d.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;this.on("error",function(){});var u=this;this.addListener("ready",function(){u.status="ready"});this.addListener("offline",function(){u.status="offline"});this.addListener("close",function(){u.destroy()});this.transport=this.options.transportFactory({host:this.host,
debug:this.options.debug,secureSignaling:this.options.secureSignaling});this.transport.onopen=function(){u.status="connected";u.setToken(u.token)};this.transport.onclose=function(){"disconnected"!=u.status&&("offline"!=u.status&&u.emit("offline",u),u.status="disconnected")};this.transport.onerror=function(a){u.emit("error",a)};this.transport.onmessage=function(a){a=c.splitObjects(a.data);for(var e=0;e<a.length;e++){var b=JSON.parse(a[e]),d=b.type,b=b.payload||{};b.gateway&&(u.gateway=b.gateway);b.region&&
(u.region=b.region);u.emit(d,b)}};this.transport.open();return this}p=h("events").EventEmitter;var b=h("util"),d=h("./log"),c=h("./util");h("./rtc");h("./heartbeat");var f=h("./wstransport").WSTransport;b.inherits(a,p);a.toString=function(){return"[Twilio.PStream class]"};a.prototype.toString=function(){return"[Twilio.PStream instance]"};a.prototype.setToken=function(a){this.log("Setting token and publishing listen");this.token=a;a={token:a,browserinfo:c.getSystemInfo()};this.publish("listen",a)};
a.prototype.register=function(a){this.publish("register",{media:a})};a.prototype.destroy=function(){this.log("Closing PStream");this.transport.close();return this};a.prototype.publish=function(a,b){var d=JSON.stringify({type:a,version:c.getPStreamVersion(),payload:b});this.transport.send(d)};l.PStream=a},{"./heartbeat":6,"./log":7,"./rtc":11,"./util":19,"./wstransport":20,events:23,util:42}],10:[function(h,p,l){var a="undefined"===typeof XMLHttpRequest?h("xmlhttprequest").XMLHttpRequest:XMLHttpRequest;
h=function(b,d,c){var f;f=f||a;var g=new f;g.open(b,d.url,!0);g.onreadystatechange=function(){4===g.readyState&&(200<=g.status&&300>g.status?c(null,g.responseText):c(Error(g.responseText)))};for(var m in d.headers)g.setRequestHeader(m,d.headers[m]);g.send(JSON.stringify(d.body))};h.get=function(a,d){return new this("GET",a,d)};h.post=function(a,d){return new this("POST",a,d)};p.exports=h},{xmlhttprequest:44}],11:[function(h,p,l){var a=h("./peerconnection");p.exports={enabled:function(b){"undefined"!==
typeof b&&(a.enabled=b);return a.enabled},getMediaEngine:function(){return"undefined"!==typeof RTCIceGatherer?"ORTC":"WebRTC"},PeerConnection:a}},{"./peerconnection":14}],12:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);b=b||{};var e=Object.assign({},m,b.thresholds);Object.defineProperties(this,{_activeWarnings:{value:new Map},_currentStreaks:{value:new Map},_peerConnection:{value:b.peerConnection,writable:!0},_sampleBuffer:{value:[]},_sampleInterval:{value:null,writable:!0},
_thresholds:{value:e},_warningsEnabled:{value:!0,writable:!0}});b.peerConnection&&this.enable();c.call(this)}function b(a,e){return e.reduce(function(e,b){return e+(b<a?1:0)},0)}function d(a,e){return e.reduce(function(e,b){return e+(b>a?1:0)},0)}var c=h("events").EventEmitter,f=h("./stats");l=h("util").inherits;var g=h("./mos"),m={audioInputLevel:{maxDuration:10},audioOutputLevel:{maxDuration:10},packetsLostFraction:{max:1},jitter:{max:30},rtt:{max:400},mos:{min:3}};l(a,c);a.createSample=function(a,
e){var b=a.packetsReceived-(e&&e.totals.packetsReceived||0),c=a.packetsLost-(e&&e.totals.packetsLost||0),d=b+c,d=0<d?c/d*100:100,f=a.packetsReceived+a.packetsLost;return{timestamp:a.timestamp,totals:{packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,packetsSent:a.packetsSent,packetsLostFraction:0<f?a.packetsLost/f*100:100,bytesReceived:a.bytesReceived,bytesSent:a.bytesSent},packetsSent:a.packetsSent-(e&&e.totals.packetsSent||0),packetsReceived:b,packetsLost:c,packetsLostFraction:d,audioInputLevel:a.audioInputLevel,
audioOutputLevel:a.audioOutputLevel,jitter:a.jitter,rtt:a.rtt,mos:g.calculate(a,e&&d)}};a.prototype.enable=function(a){if(a){if(this._peerConnection&&a!==this._peerConnection)throw Error("Attempted to replace an existing PeerConnection in RTCMonitor.enable");this._peerConnection=a}if(!this._peerConnection)throw Error("Can not enable RTCMonitor without a PeerConnection");this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),1E3);return this};a.prototype.disable=function(){clearInterval(this._sampleInterval);
this._sampleInterval=null;return this};a.prototype.getSample=function(){var b=this._peerConnection,e=this;return new Promise(function(c,d){f(b,function(b,f){b?d(b):c(a.createSample(f,e._sampleBuffer.length&&e._sampleBuffer[e._sampleBuffer.length-1]))})})};a.prototype._fetchSample=function(a){var e=this;return this.getSample().then(function(a){e._addSample(a);e._raiseWarnings();e.emit("sample",a);return a},function(a){e.disable();e.emit("error",a)})};a.prototype._addSample=function(a){var e=this._sampleBuffer;
e.push(a);5<e.length&&e.splice(0,e.length-5)};a.prototype._raiseWarnings=function(){if(this._warningsEnabled)for(var a in this._thresholds)this._raiseWarningsForStat(a)};a.prototype.enableWarnings=function(){this._warningsEnabled=!0;return this};a.prototype.disableWarnings=function(){this._warningsEnabled&&this._activeWarnings.clear();this._warningsEnabled=!1;return this};a.prototype._raiseWarningsForStat=function(a){var e=this._sampleBuffer,c=this._thresholds[a],n=e.slice(-5),n=n.map(function(e){return e[a]});
if(!n.some(function(a){return"undefined"===typeof a||null===a})){if("number"===typeof c.max){var f=d(c.max,n);3<=f?this._raiseWarning(a,"max",{values:n}):0>=f&&this._clearWarning(a,"max",{values:n})}"number"===typeof c.min&&(f=b(c.min,n),3<=f?this._raiseWarning(a,"min",{values:n}):0>=f&&this._clearWarning(a,"min",{values:n}));"number"===typeof c.maxDuration&&1<e.length&&(n=e.slice(-2),e=n[0][a],f=n[1][a],n=this._currentStreaks.get(a)||0,e=e===f?n+1:0,this._currentStreaks.set(a,e),e>=c.maxDuration?
this._raiseWarning(a,"maxDuration",{value:e}):0===e&&this._clearWarning(a,"maxDuration",{value:n}))}};a.prototype._clearWarning=function(a,e,b){var c=a+":"+e,d=this._activeWarnings.get(c);!d||5E3>Date.now()-d.timeRaised||(this._activeWarnings["delete"](c),this.emit("warning-cleared",Object.assign({name:a,threshold:{name:e,value:this._thresholds[a][e]}},b)))};a.prototype._raiseWarning=function(a,e,b){var c=a+":"+e;this._activeWarnings.has(c)||(this._activeWarnings.set(c,{timeRaised:Date.now()}),this.emit("warning",
Object.assign({name:a,threshold:{name:e,value:this._thresholds[a][e]}},b)))};p.exports=a},{"./mos":13,"./stats":15,events:23,util:42}],13:[function(h,p,l){p.exports={calculate:function(a,b){if(!a||"number"!==typeof a.rtt||"number"!==typeof a.jitter||"number"!==typeof a.packetsLost||"number"!==typeof b)return null;var d,c=a.rtt+2*a.jitter+10;d=0;switch(!0){case 160>c:d=94.768-c/40;break;case 1E3>c:d=94.768-(c-120)/10;break;case 1E3<=c:d=94.768-c/100}c=.01;switch(!0){case -1===b:d=c=0;break;case b<=
d/2.5:c=2.5;break;case b>d/2.5&&100>b:c=.25}d-=b*c;d=1+.035*d+7E-6*d*(d-60)*(100-d);return 1<=d&&4.6>d?d:null}}},{}],14:[function(h,p,l){function a(e,b){if(!(this instanceof a))return new a(e,b);var c=function(){};this.onicecandidate=this.oniceconnectionstatechange=this.onsignalingstatechange=this.onclose=this.onerror=this.onopen=c;this.version=null;this.pstream=b.stream;this.stream=null;this.video="undefined"!==typeof document&&document.createElement("video");this.video.autoplay="autoplay";this.device=
b;this.status="connecting";this._dtmfSender=this.callSid=null;this._dtmfSenderUnsupported=!1;this._callEvents=[];this._nextTimeToPublish=Date.now();this._onAnswer=c;d.mixinLog(this,"[Twilio.PeerConnection]");this.log.enabled=this.device.options.debug;this.log.warnings=this.device.options.warnings;this._iceConnectionStateMachine=new f(m,"new");this._signalingStateMachine=new f(k,"stable");return this}function b(a){"function"===typeof MediaStreamTrack.prototype.stop?("function"===typeof a.getAudioTracks?
a.getAudioTracks():a.audioTracks).forEach(function(a){a.stop()}):a.stop()}var d=h("../log"),c=h("ortc-adapter");h("stacktrace-js");var f=h("../statemachine"),g=h("../util"),m={"new":["checking","closed"],checking:["new","connected","failed","closed","completed"],connected:["new","disconnected","completed","closed"],completed:["new","disconnected","closed","completed"],failed:["new","disconnected","closed"],disconnected:["connected","completed","failed","closed"],closed:[]},k={stable:["have-local-offer",
"have-remote-offer","closed"],"have-local-offer":["stable","closed"],"have-remote-offer":["stable","closed"],closed:[]};a.prototype.uri=function(){return this._uri};a.prototype.openHelper=function(e,b){var c=this;a.getUserMedia({audio:b},function(a){c.stream=a;e()},function(a){a.code&&a.code===a.PERMISSION_DENIED||a.name&&"PermissionDeniedError"===a.name?e({error:a,message:"User denied access to microphone, or the web browser did not allow microphone access at this address.",code:31208}):e({error:a,
message:"Error occurred while accessing microphone.",code:31201})})};a.prototype._setupPeerConnection=function(e,b){var c=a.protocol;c.create(this.log,e,b);c.pc.addStream(this.stream);var d=this;c.pc.onaddstream=function(a){"undefined"!==typeof d.video.srcObject?d.video.srcObject=a.stream:"undefined"!==typeof d.video.mozSrcObject?d.video.mozSrcObject=a.stream:"undefined"!==typeof d.video.src?d.video.src=(window.URL||window.webkitURL).createObjectURL(a.stream):d.log("Error attaching stream to element.")};
return c};a.prototype._setupChannel=function(){var a=this,b=this.version.pc;a.version.pc.onopen=function(){a.status="open";a.onopen()};a.version.pc.onstatechange=function(b){a.version.pc&&"stable"==a.version.pc.readyState&&(a.status="open",a.onopen())};a.version.pc.onsignalingstatechange=function(c){c=b.signalingState;a.log('signalingState is "'+c+'"');try{a._signalingStateMachine.transition(c)}catch(d){}a.version.pc&&"stable"==a.version.pc.signalingState&&(a.status="open",a.onopen());a.onsignalingstatechange(b.signalingState)};
b.onicecandidate=function(b){a.onicecandidate(b.candidate)};b.oniceconnectionstatechange=function(){var c=b.iceConnectionState,d='iceConnectionState is "'+c+'"';try{a._iceConnectionStateMachine.transition(c)}catch(f){}var g=null;switch(c){case "disconnected":g="ICE liveness checks failed. May be having trouble connecting to Twilio.";case "failed":var k="failed"===c;a.log(d+(k?"; disconnecting":""));a.onerror({info:{code:31003,message:g||"ICE negotiation with Twilio failed. Call will terminate."},
disconnect:k});break;default:a.log(d)}a.oniceconnectionstatechange(c)}};a.prototype._initializeMediaStream=function(a,b){if("open"==this.status)return!1;if("disconnected"==this.pstream.status)return this.onerror({info:{code:31E3,message:"Cannot establish connection. Client is disconnected"}}),this.close(),!1;this.version=this._setupPeerConnection(a,b);this._setupChannel();return!0};a.prototype.makeOutgoingCall=function(a,b,c,d,f){if(this._initializeMediaStream(c,d)){var k=this;this.callSid=b;var m=
function(){f(k.version.pc)},h=function(a){k.onerror({info:{code:31E3,message:"Error processing answer: "+(a.message||a)}})};this._onAnswer=function(a){"closed"!=k.status&&k.version.processAnswer(a.sdp,m,h)};this.pstream.once("answer",this._onAnswer);this.version.createOffer({audio:!0},function(){"closed"!=k.status&&k.pstream.publish("invite",{sdp:k.version.getSDP(),callsid:k.callSid,twilio:{accountsid:k.device.token?g.objectize(k.device.token).iss:null,params:a}})},function(a){k.onerror({info:{code:31E3,
message:"Error creating the offer: "+(a.message||a)}})})}};a.prototype.answerIncomingCall=function(a,b,c,d,f){if(this._initializeMediaStream(c,d)){this.callSid=a;var g=this;this.version.processSDP(b,{audio:!0},function(){"closed"!=g.status&&(g.pstream.publish("answer",{callsid:a,sdp:g.version.getSDP()}),f(g.version.pc))},function(a){g.onerror({info:{code:31E3,message:"Error creating the answer: "+(a.message||a)}})})}};a.prototype.close=function(){this.version&&this.version.pc&&("closed"!==this.version.pc.signalingState&&
this.version.pc.close(),this.version.pc=null);this.stream&&(b(this.stream),this.stream=null);this.pstream&&this.pstream.removeListener("answer",this._onAnswer);this.video.src="";this.status="closed";this.onclose()};a.prototype.reject=function(a){this.callSid=a};a.prototype.ignore=function(a){this.callSid=a};a.prototype.attachAudio=function(a){this.stream&&(("function"===typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled=!0);a&&"function"==typeof a&&
a()};a.prototype.detachAudio=function(a){this.stream&&(("function"===typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled=!1);a&&"function"==typeof a&&a()};a.prototype.isAudioAttached=function(){return this.stream?("function"===typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled:!1};a.getUserMedia=function(a,b,c){"undefined"!=typeof navigator&&("function"==typeof navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(a,
b,c):"function"==typeof navigator.mozGetUserMedia?navigator.mozGetUserMedia(a,b,c):"function"===typeof navigator.getUserMedia?navigator.getUserMedia(a,b,c):this.log("No getUserMedia() implementation available"))};a.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender)return this._dtmfSender;if(this._dtmfSenderUnsupported)return null;var a=this.version.pc;if(!a)return this.log("No RTCPeerConnection available to call createDTMFSender on"),null;if("function"!==typeof a.createDTMFSender)return this.log("RTCPeerConnection does not support createDTMFSender"),
this._dtmfSenderUnsupported=!0,null;for(var b=a.getLocalStreams(),c,d,f=0;f<b.length;f++)if(c=b[f],c="function"===typeof c.getAudioTracks?c.getAudioTracks():c.audioTracks,c.length){d=c[0];break}if(!d)return this.log("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null;this.log("Creating RTCDTMFSender");return this._dtmfSender=a=a.createDTMFSender(d)};h=function(){"undefined"!=typeof window&&("function"==typeof window.webkitRTCPeerConnection?this.RTCPeerConnection=
webkitRTCPeerConnection:"function"==typeof window.mozRTCPeerConnection?(this.RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate):"undefined"!==typeof RTCIceGatherer?(this.RTCPeerConnection=c.RTCPeerConnection,RTCSessionDescription=c.RTCSessionDescription,RTCIceCandidate=c.RTCIceCandidate):this.log("No RTCPeerConnection implementation available"))};h.prototype.create=function(a,b,c){this.log=a;this.pc=new this.RTCPeerConnection({iceServers:c},
b)};h.prototype.createModernConstraints=function(a){if("undefined"===typeof a)return null;var b={};"undefined"!==typeof webkitRTCPeerConnection?(b.mandatory={},"undefined"!==typeof a.audio&&(b.mandatory.OfferToReceiveAudio=a.audio),"undefined"!==typeof a.video&&(b.mandatory.OfferToReceiveVideo=a.video)):("undefined"!==typeof a.audio&&(b.offerToReceiveAudio=a.audio),"undefined"!==typeof a.video&&(b.offerToReceiveVideo=a.video));return b};h.prototype.createOffer=function(a,b,c){var d=this;this.pc.createOffer(function(a){d.pc&&
d.pc.setLocalDescription(new RTCSessionDescription(a),b,c)},c,this.createModernConstraints(a))};h.prototype.createAnswer=function(a,b,c){var d=this;this.pc.createAnswer(function(a){d.pc&&d.pc.setLocalDescription(new RTCSessionDescription(a),b,c)},c,this.createModernConstraints(a))};h.prototype.processSDP=function(a,b,c,d){var f=this;this.pc.setRemoteDescription(new RTCSessionDescription({sdp:a,type:"offer"}),function(){f.createAnswer(b,c,d)},d)};h.prototype.getSDP=function(){return this.pc.localDescription.sdp};
h.prototype.processAnswer=function(a,b,c){this.pc&&this.pc.setRemoteDescription(new RTCSessionDescription({sdp:a,type:"answer"}),b,c)};h.test=function(){if("object"==typeof navigator){if(navigator.webkitGetUserMedia&&"function"==typeof window.webkitRTCPeerConnection)return!0;if(navigator.mozGetUserMedia&&"function"==typeof window.mozRTCPeerConnection){try{if("function"!==typeof(new window.mozRTCPeerConnection).getLocalStreams)return!1}catch(a){return!1}return!0}if("undefined"!==typeof RTCIceGatherer)return!0}};
h=h.test()?new h:null;a.protocol=h;a.enabled=!!a.protocol;p.exports=a},{"../log":7,"../statemachine":18,"../util":19,"ortc-adapter":27,"stacktrace-js":40}],15:[function(h,p,l){function a(a,e){var d=[],n=[];a.result().forEach(function(a){var e=null;switch(a.type){case "googCandidatePair":a:{for(var e={},f={},g=a.names(),k=a.timestamp?Number(a.timestamp):null,m=0;m<g.length;m++){var h=g[m],q=a.stat(h);switch(h){case "googActiveConnection":if("true"!==q){e=null;break a}break;case "googLocalAddress":e.localAddress=
q;break;case "googRemoteAddress":e.remoteAddress=q;break;case "googRtt":e.rtt=Number(q);break;case "":break;default:f[h]=q}}e.timestamp=k;e=c(e,f)}break;case "ssrc":e=b(a);break;default:n.push(a)}e&&d.push(e)});if(0===d.length||0===(d=f(d)).length)return e(null,{});var g=d.reduceRight(function(a,b){for(var c in b)a[c]=b[c];return a},{});e(null,g)}function b(a){var b={},d={},f=a.names(),g=a.timestamp?Number(a.timestamp):null;f.forEach(function(c){var f=a.stat(c);switch(c){case "googCodecName":""!==
f&&(b.codecName=f);break;case "googJitterBufferMs":b.googJitterBufferMs=Number(f);break;case "googJitterReceived":c=Number(f);-1!==c&&(b.jitter=c);break;case "bytesReceived":case "bytesSent":case "packetsReceived":case "packetsSent":case "timestamp":case "audioInputLevel":case "audioOutputLevel":b[c]=Number(f);break;case "packetsLost":f=Number(f);-1!==f&&(b[c]=f);break;default:d[c]=f}});b.timestamp=g;return c(b,d)}function d(a,b){var d=[],n=[];a.forEach(function(a){var b=null;switch(a.type){case "inboundrtp":var e=
{},b={},f;for(f in a){var g=a[f];switch(f){case "mozRtt":e.rtt=g;break;case "timestamp":e.timestamp=g?Number(g):null;break;case "jitter":e[f]=1E3*g;break;case "bytesReceived":case "packetsLost":case "packetsReceived":e[f]=g;break;default:b[f]=g}}b=c(e,b);break;case "outboundrtp":if(!1===a.isRemote){f={};b={};for(e in a)switch(g=a[e],e){case "timestamp":f.timestamp=g?Number(g):null;case "bytesSent":case "packetsSent":f[e]=g;break;default:b[e]=g}b=c(f,b)}break;default:n.push(a)}b&&d.push(b)});if(0===
d.length||0===(d=f(d)).length)return b(null,{});var g=d.reduceRight(function(a,b){for(var c in b)a[c]=b[c];return a},{});b(null,g)}function c(a,b){var c=null;g(a)||(c=c||{},c.known=a);g(b)||(c=c||{},c.unknown=b);return c}function f(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];d.known&&b.push(d.known)}return b}function g(a){if(!a)return!0;for(var b in a)return!1;return!0}function m(a,b){return function(){var c=Array.prototype.slice.call(arguments);c.push(b);return a.apply(null,c)}}p.exports=function(b,
c){var f=Error("WebRTC statistics are unsupported");b?"undefined"===typeof navigator||"function"!==typeof b.getStats?c(f):navigator.webkitGetUserMedia?b.getStats(m(a,c),c):navigator.mozGetUserMedia?b.getStats(null,m(d,c),c):c(f):c(Error("PeerConnection is null"))}},{}],16:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);this.id=a.nextId++;this.maxDuration=b.maxDuration;a.items[this.id]=this;this.create(!!b.loop);return this}h={create:function(a){this.audio=document.createElement("audio");
this.audio.loop=a;this.playing=!1;var b=this;this.audio.addEventListener("ended",function(){b.playing=!1})},buffer:function(){},play:function(){if(!this.playing){var a=this.audio;this.rewind();var b=this,f=this.maxDuration;f&&f<1E3*a.duration&&setTimeout(function(){a.pause();b.playing=!1},f);this.playing=!0;a.play()}},load:function(a){this.audio.src=a},stop:function(){this.playing=!1;this.audio.pause();this.rewind()},destroy:function(){this.audio.src="";delete this.audio},rewind:function(){this.audio.currentTime=
0;this.audio.currentTime&&this.audio.load()}};p={create:function(){},buffer:function(a){},play:function(){},load:function(a){},stop:function(){},destroy:function(){}};if("undefined"===typeof window)for(var b in p)a.prototype[b]=p[b];else a.prototype=h;a.nextId=0;a.debug=!1;a.tasks=[];a.items={};l.Sound=a},{}],17:[function(h,p,l){function a(a,b){return function(){var f=Array.prototype.slice(arguments);b.apply(a,f)}}function b(){if(!(this instanceof b))return new b;this.cache={}}b.prototype.add=function(a,
b,f){f=f||{};if(!(f instanceof Object))throw new TypeError("Bad envelope type; expected Object");b instanceof Array||(b=[b]);this.cache[a]={starttime:null,sounds:b,envelope:f}};b.prototype.play=function(a,b,f){b=b||0;f=f||1;if(a in this.cache){a=this.cache[a];for(var g=0;g<a.sounds.length;g++)a.sounds[g].play(b,f);a.starttime=(new Date).getTime()}};b.prototype.stop=function(a){if(a in this.cache){var b=this.cache[a];a=b.envelope.release||0;var f=function(){for(var a=0;a<b.sounds.length;a++)b.sounds[a].stop()},
g=(new Date).getTime(),g=Math.max(0,a-(g-b.starttime));0==a?f():setTimeout(f,g)}};b.prototype.envelope=function(a,b){if(a in this.cache){var f=this.cache[a],g;for(g in b)f.envelope[g]=b[g]}};b.prototype.playseq=function(){var b=null,c=[],f=function(){var g=c.shift();if(g){var m=g[0],k=g[1]||0,g=g[2]||0;m in this.cache&&this.play(m);b=setTimeout(a(this,f),k+g)}else b=null};return function(g){for(var m=0;m<g.length;m++)c.push(g[m]);null==b&&(b=setTimeout(a(this,f),0))}}();l.SoundCache=b},{}],18:[function(h,
p,l){function a(b,d){if(!(this instanceof a))return new a(b,d);var g=d;Object.defineProperties(this,{_currentState:{get:function(){return g},set:function(a){g=a}},currentState:{enumerable:!0,get:function(){return g}},states:{enumerable:!0,value:b},transitions:{enumerable:!0,value:[]}});Object.freeze(this)}function b(a,b){Object.defineProperties(this,{from:{enumerable:!0,value:a},to:{enumerable:!0,value:b}})}function d(a,f){if(!(this instanceof d))return new d(a,f);Error.call(this);b.call(this,a,f);
Object.defineProperties(this,{message:{enumerable:!0,value:"Invalid transition from "+("string"===typeof a?'"'+a+'"':"null")+' to "'+f+'"'}});Object.freeze(this)}h=h("util").inherits;a.prototype.transition=function(a){var f=this.currentState,g=this.states[f],f=g&&-1!==g.indexOf(a)?new b(f,a):new d(f,a);this.transitions.push(f);this._currentState=a;if(f instanceof d)throw f;return this};h(d,Error);p.exports=a},{util:42}],19:[function(h,p,l){(function(a){function b(a){if(!(this instanceof b))return new b(a);
this.message=a}function d(a){return function(){var b=Array.prototype.slice.call(arguments,0);a.memo=a.memo||{};return a.memo[b]?a.memo[b]:a.memo[b]=a.apply(null,b)}}function c(a){a=a.split(".");if(3!=a.length)throw new b("Wrong number of segments");return A(a[1])}function f(a){if(""==a)return{};if(-1==a.indexOf("&")&&-1==a.indexOf("="))return a;a=a.split("&");for(var b={},c=0;c<a.length;c++){var q=a[c].split("=");b[decodeURIComponent(q[0])]=f(decodeURIComponent(q[1]))}return b}function g(b){try{return btoa(b)}catch(c){return(new a(b)).toString("base64")}}
function m(b){try{return atob(b)}catch(c){try{return(new a(b,"base64")).toString("ascii")}catch(e){return base64.decode(b)}}}function k(a){var b=[],c;for(c in a){var q="object"==typeof a[c]?k(a[c]):a[c];b.push(encodeURIComponent(c)+"="+encodeURIComponent(q))}return b.join("&")}function e(a,b){return a===b?!0:typeof a!==typeof b?!1:a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():"object"!==typeof a&&"object"!==typeof b?a==b:u(a,b)}function u(a,b){if(void 0===a||null===a||void 0===b||
null===b||a.prototype!==b.prototype)return!1;try{var c=D(a),q=D(b)}catch(d){return!1}if(c.length!==q.length)return!1;c.sort();q.sort();for(q=c.length-1;0<=q;q--){var v=c[q];if(!e(a[v],b[v]))return!1}return!0}var n=h("events").EventEmitter;b.prototype.toString=function(){return"Twilio.Exception: "+this.message};var A=d(function(a){var b=a.length%4;0<b&&(a+=Array(4-b+1).join("="));a=a.replace(/-/g,"+").replace(/_/g,"/");a=m(a);return JSON.parse(a)}),z=d(function(a){a=c(a);for(var e=0===a.scope.length?
[]:a.scope.split(" "),d={},q=0;q<e.length;q++){var v;v=e[q].match(/^scope:(\w+):(\w+)\??(.*)$/);if(!v||4!=v.length)throw new b("Bad scope URI");v={service:v[1],privilege:v[2],params:f(v[3])};d[v.service+":"+v.privilege]=v}a.scope=d;return a}),p=function(){function a(){this.set={}}a.prototype.clear=function(){this.set={}};a.prototype.put=function(b){return this.set[b]=a.DUMMY};a.prototype.del=function(a){return delete this.set[a]};a.prototype.map=function(a,b){var q=[],c;for(c in this.set)q.push(a.call(b,
c));return q};a.DUMMY={};return a}(),y="",D="function"===typeof Object.keys?Object.keys:function(a){var b=[],c;for(c in a)b.push(c);return b};l.getPStreamVersion=function(){return"1.3"};l.getReleaseVersion=function(){return"1.3.11"};l.getSoundVersion=function(){return"1.0.0"};l.encodescope=function(a,b,c){a=["scope",a,b].join(":");b=!0;for(var q in c){b=!1;break}return b?a:a+"?"+k(c)};l.dummyToken=function(a){var b={iss:"AC1111111111111111111111111111111",exp:14E8},c;for(c in b)a[c]=a[c]||b[c];a=
g(JSON.stringify(a));a=a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return["*",a,"*"].join(".")};l.Exception=b;l.decode=c;l.btoa=g;l.atob=m;l.objectize=z;l.urlencode=function(a,b){var c=[];b=b||!1;for(var q in a)if(b&&a[q]instanceof Array)for(var e in a[q]){var d=a[q][e];c.push(encodeURIComponent(q)+"="+encodeURIComponent(d))}else d=a[q],c.push(encodeURIComponent(q)+"="+encodeURIComponent(d));return c.join("&")};l.Set=p;l.bind=function(a,b){var c=Array.prototype.slice.call(arguments,2);
return function(){var q=Array.prototype.slice.call(arguments);return a.apply(b,c.concat(q))}};l.getSystemInfo=function(){h("./rtc");var a="undefined"!=typeof navigator?navigator:{};return{p:"browser",v:"1.3",h:"aa586e9",browser:{userAgent:a.userAgent||"unknown",platform:a.platform||"unknown"},plugin:"rtc"}};l.splitObjects=function(a,b){var c;c="string"!=typeof a?"":a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");return 0==c.length?[]:c.split("\n")};l.generateConnectionUUID=function(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};l.getTwilioRoot=function(){return y};l.setTwilioRoot=function(a){y=a};l.monitorEventEmitter=function(a,b){function c(q){var e=n.listenerCount(b,q);q="The number of "+q+" listeners on "+a+" exceeds the recommended number of 10. While twilio.js will continue to function normally, this may be indicative of an application error. Note that "+q+" listeners exist for the lifetime of the "+a+".";10<=e&&("undefined"!==typeof console&&
(console.warn?console.warn(q):console.log&&console.log(q)),b.removeListener("newListener",c))}b.setMaxListeners(0);b.on("newListener",c)};l.deepEqual=e}).call(this,h("buffer").Buffer)},{"./rtc":11,buffer:22,events:23}],20:[function(h,p,l){function a(b){var c=this instanceof a?this:new a(b);c.sock=null;var m=function(){};c.onopen=m;c.onclose=m;c.onmessage=m;c.onerror=m;m={logPrefix:"[WSTransport]",chunderw:"chunderw-vpc-gll.twilio.com",reconnect:!0,debug:!1,secureSignaling:!0};b=b||{};for(var k in m)k in
b||(b[k]=m[k]);c.options=b;d.mixinLog(c,c.options.logPrefix);c.log.enabled=c.options.debug;c.defaultReconnect=c.options.reconnect;c.uri=(c.options.secureSignaling?"wss://":"ws://")+c.options.host+"/signal";return c}var b=h("./heartbeat").Heartbeat,d=h("./log"),c=h("ws");a.prototype.msgQueue=[];a.prototype.open=function(a){this.log("Opening socket");this.sock&&2>this.sock.readyState?this.log("Socket already open."):(this.options.reconnect=this.defaultReconnect,this.heartbeat&&(this.heartbeat.onsleep=
function(){}),this.heartbeat=new b({interval:15}),this.sock=this._connect(a))};a.prototype.send=function(a){if(this.sock)if(0==this.sock.readyState)this.msgQueue.push(a);else try{this.sock.send(a)}catch(b){this.log("Error while sending. Closing socket: "+b.message),this.sock.close()}};a.prototype.close=function(){this.log("Closing socket");this.options.reconnect=!1;this.sock&&(this.sock.close(),this.sock=null);this.heartbeat.onsleep=function(){}};a.prototype._cleanupSocket=function(a){if(a){this.log("Cleaning up socket");
var b=function(){};a.onopen=function(){a.close()};a.onmessage=b;a.onerror=b;a.onclose=b;2>a.readyState&&a.close()}};a.prototype._connect=function(a){var b=++a||1;this.log("attempting to connect");var d=null;try{d=new c(this.uri)}catch(h){this.onerror({code:31E3,message:h.message||"Could not connect to "+this.uri});this.close();return}var k=this,e=this.sock,l=null,n=setTimeout(function(){k.log("connection attempt timed out");d.onclose=function(){};d.close();k.onclose();k._tryReconnect(b)},5E3);d.onopen=
function(){clearTimeout(n);k._cleanupSocket(e);l=(new Date).getTime();k.log("Socket opened");k.heartbeat.onsleep=function(){k.log("Heartbeat timed out. closing socket");k.sock.onclose=function(){};k.sock.close();k.onclose();k._tryReconnect(b)};k.heartbeat.beat();k.onopen();for(var a=0;a<k.msgQueue.length;a++)k.sock.send(k.msgQueue[a]);k.msgQueue=[]};d.onclose=function(){clearTimeout(n);k._cleanupSocket(e);k.heartbeat.onsleep=function(){};l&&10<((new Date).getTime()-l)/1E3&&(b=1);k.log("Socket closed");
k.onclose();k._tryReconnect(b)};d.onerror=function(a){k.log("Socket received error: "+a.message);k.onerror({code:31E3,message:a.message||"WSTransport socket error"})};d.onmessage=function(a){k.heartbeat.beat();if("\n"==a.data)k.send("\n");else k.onmessage(a)};return d};a.prototype._tryReconnect=function(a){a=a||0;if(this.options.reconnect){this.log("Attempting to reconnect.");var b=this,c=0,c=5>a?30+Math.round(50*Math.random()*Math.pow(2,a)):3E3;setTimeout(function(){b.open(a)},c)}};l.WSTransport=
a},{"./heartbeat":6,"./log":7,ws:43}],21:[function(h,p,l){(function(a){function b(a){a=a.charCodeAt(0);if(43===a)return 62;if(47===a)return 63;if(48>a)return-1;if(58>a)return a-48+52;if(91>a)return a-65;if(123>a)return a-97+26}var d="undefined"!==typeof Uint8Array?Uint8Array:Array;a.toByteArray=function(a){function f(a){h[n++]=a}var g,m,k,e,h;if(0<a.length%4)throw Error("Invalid string. Length must be a multiple of 4");g=a.length;e="="===a.charAt(g-2)?2:"="===a.charAt(g-1)?1:0;h=new d(3*a.length/
4-e);m=0<e?a.length-4:a.length;var n=0;for(g=0;g<m;g+=4)k=b(a.charAt(g))<<18|b(a.charAt(g+1))<<12|b(a.charAt(g+2))<<6|b(a.charAt(g+3)),f((k&16711680)>>16),f((k&65280)>>8),f(k&255);2===e?(k=b(a.charAt(g))<<2|b(a.charAt(g+1))>>4,f(k&255)):1===e&&(k=b(a.charAt(g))<<10|b(a.charAt(g+1))<<4|b(a.charAt(g+2))>>2,f(k>>8&255),f(k&255));return h};a.fromByteArray=function(a){var b,d=a.length%3,m="",k,e;b=0;for(e=a.length-d;b<e;b+=3)k=(a[b]<<16)+(a[b+1]<<8)+a[b+2],k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>
18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k&63),m+=k;switch(d){case 1:k=a[a.length-1];m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>2);m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k<<4&63);m+="==";break;case 2:k=(a[a.length-2]<<8)+
a[a.length-1],m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>10),m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>4&63),m+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k<<2&63),m+="="}return m}})("undefined"===typeof l?this.base64js={}:l)},{}],22:[function(h,p,l){function a(b,c,e){if(!(this instanceof a))return new a(b,c,e);var d=typeof b,f;if("number"===d)f=0<b?b>>>0:0;else if("string"===d){if("base64"===
c)for(b=(b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")).replace(t,"");0!==b.length%4;)b+="=";f=a.byteLength(b,c)}else if("object"===d&&null!==b)"Buffer"===b.type&&D(b.data)&&(b=b.data),f=0<+b.length?Math.floor(+b.length):0;else throw new TypeError("must start with number, buffer, array or string");if(this.length>w)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+w.toString(16)+" bytes");var n;a.TYPED_ARRAY_SUPPORT?n=a._augment(new Uint8Array(f)):(n=this,n.length=f,n._isBuffer=
!0);if(a.TYPED_ARRAY_SUPPORT&&"number"===typeof b.byteLength)n._set(b);else{var g=b;if(D(g)||a.isBuffer(g)||g&&"object"===typeof g&&"number"===typeof g.length)if(a.isBuffer(b))for(c=0;c<f;c++)n[c]=b.readUInt8(c);else for(c=0;c<f;c++)n[c]=(b[c]%256+256)%256;else if("string"===d)n.write(b,0,c);else if("number"===d&&!a.TYPED_ARRAY_SUPPORT&&!e)for(c=0;c<f;c++)n[c]=0}return n}function b(a,b,c){var e="";for(c=Math.min(a.length,c);b<c;b++)e+=String.fromCharCode(a[b]);return e}function d(a,b,c){if(0!==a%
1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function c(b,c,e,d,f,n){if(!a.isBuffer(b))throw new TypeError("buffer must be a Buffer instance");if(c>f||c<n)throw new TypeError("value is out of bounds");if(e+d>b.length)throw new TypeError("index out of range");}function f(a,b,c,e){0>b&&(b=65535+b+1);for(var d=0,f=Math.min(a.length-c,2);d<f;d++)a[c+d]=(b&255<<8*(e?d:1-d))>>>8*(e?d:1-d)}function g(a,b,c,e){0>b&&(b=4294967295+
b+1);for(var d=0,f=Math.min(a.length-c,4);d<f;d++)a[c+d]=b>>>8*(e?d:3-d)&255}function m(a,b,c,e,d,f){if(b>d||b<f)throw new TypeError("value is out of bounds");if(c+e>a.length)throw new TypeError("index out of range");}function k(a,b,c,e,d){d||m(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);y.write(a,b,c,e,23,4);return c+4}function e(a,b,c,e,d){d||m(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);y.write(a,b,c,e,52,8);return c+8}function u(a){for(var b=[],c=0;c<a.length;c++){var e=
a.charCodeAt(c);if(127>=e)b.push(e);else{var d=c;55296<=e&&57343>=e&&c++;e=encodeURIComponent(a.slice(d,c+1)).substr(1).split("%");for(d=0;d<e.length;d++)b.push(parseInt(e[d],16))}}return b}function n(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b}function A(a,b,c,e,d){d&&(e-=e%d);for(d=0;d<e&&!(d+c>=b.length||d>=a.length);d++)b[d+c]=a[d];return d}function z(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var x=h("base64-js"),y=h("ieee754"),
D=h("is-array");l.Buffer=a;l.SlowBuffer=a;l.INSPECT_MAX_BYTES=50;a.poolSize=8192;var w=1073741823;a.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);b.foo=function(){return 42};return 42===b.foo()&&"function"===typeof b.subarray&&0===(new Uint8Array(1)).subarray(1,1).byteLength}catch(c){return!1}}();a.isBuffer=function(a){return!(null==a||!a._isBuffer)};a.compare=function(b,c){if(!a.isBuffer(b)||!a.isBuffer(c))throw new TypeError("Arguments must be Buffers");for(var e=
b.length,d=c.length,f=0,n=Math.min(e,d);f<n&&b[f]===c[f];f++);f!==n&&(e=b[f],d=c[f]);return e<d?-1:d<e?1:0};a.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};a.concat=function(b,c){if(!D(b))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===b.length)return new a(0);if(1===b.length)return b[0];var e;if(void 0===
c)for(e=c=0;e<b.length;e++)c+=b[e].length;var d=new a(c),f=0;for(e=0;e<b.length;e++){var n=b[e];n.copy(d,f);f+=n.length}return d};a.byteLength=function(a,b){var c;a+="";switch(b||"utf8"){case "ascii":case "binary":case "raw":c=a.length;break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=2*a.length;break;case "hex":c=a.length>>>1;break;case "utf8":case "utf-8":c=u(a).length;break;case "base64":c=x.toByteArray(a).length;break;default:c=a.length}return c};a.prototype.length=void 0;a.prototype.parent=
void 0;a.prototype.toString=function(a,c,e){var d=!1;c>>>=0;e=void 0===e||Infinity===e?this.length:e>>>0;a||(a="utf8");0>c&&(c=0);e>this.length&&(e=this.length);if(e<=c)return"";for(;;)switch(a){case "hex":a=c;c=e;e=this.length;if(!a||0>a)a=0;if(!c||0>c||c>e)c=e;d="";for(e=a;e<c;e++)a=d,d=this[e],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":d=a="";for(e=Math.min(this.length,e);c<e;c++)127>=this[c]?(a+=z(d)+String.fromCharCode(this[c]),d=""):d+="%"+this[c].toString(16);
return a+z(d);case "ascii":return b(this,c,e);case "binary":return b(this,c,e);case "base64":return c=0===c&&e===this.length?x.fromByteArray(this):x.fromByteArray(this.slice(c,e)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(c,e);e="";for(a=0;a<c.length;a+=2)e+=String.fromCharCode(c[a]+256*c[a+1]);return e;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}};a.prototype.equals=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");
return 0===a.compare(this,b)};a.prototype.inspect=function(){var a="",b=l.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"<Buffer "+a+">"};a.prototype.compare=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return a.compare(this,b)};a.prototype.get=function(a){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(a)};a.prototype.set=function(a,b){console.log(".set() is deprecated. Access using array indexes instead.");
return this.writeUInt8(a,b)};a.prototype.write=function(a,b,c,e){if(isFinite(b))isFinite(c)||(e=c,c=void 0);else{var d=e;e=b;b=c;c=d}b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&(c=d)):c=d;e=String(e||"utf8").toLowerCase();switch(e){case "hex":b=Number(b)||0;e=this.length-b;c?(c=Number(c),c>e&&(c=e)):c=e;e=a.length;if(0!==e%2)throw Error("Invalid hex string");c>e/2&&(c=e/2);for(e=0;e<c;e++){d=parseInt(a.substr(2*e,2),16);if(isNaN(d))throw Error("Invalid hex string");this[b+e]=d}a=e;break;case "utf8":case "utf-8":a=
A(u(a),this,b,c);break;case "ascii":a=A(n(a),this,b,c);break;case "binary":a=A(n(a),this,b,c);break;case "base64":a=A(x.toByteArray(a),this,b,c);break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":for(var f,d=[],g=0;g<a.length;g++)f=a.charCodeAt(g),e=f>>8,f%=256,d.push(f),d.push(e);a=A(d,this,b,c,2);break;default:throw new TypeError("Unknown encoding: "+e);}return a};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};a.prototype.slice=
function(b,c){var e=this.length;b=~~b;c=void 0===c?e:~~c;0>b?(b+=e,0>b&&(b=0)):b>e&&(b=e);0>c?(c+=e,0>c&&(c=0)):c>e&&(c=e);c<b&&(c=b);if(a.TYPED_ARRAY_SUPPORT)return a._augment(this.subarray(b,c));for(var e=c-b,d=new a(e,void 0,!0),f=0;f<e;f++)d[f]=this[f+b];return d};a.prototype.readUInt8=function(a,b){b||d(a,1,this.length);return this[a]};a.prototype.readUInt16LE=function(a,b){b||d(a,2,this.length);return this[a]|this[a+1]<<8};a.prototype.readUInt16BE=function(a,b){b||d(a,2,this.length);return this[a]<<
8|this[a+1]};a.prototype.readUInt32LE=function(a,b){b||d(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};a.prototype.readUInt32BE=function(a,b){b||d(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};a.prototype.readInt8=function(a,b){b||d(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};a.prototype.readInt16LE=function(a,b){b||d(a,2,this.length);var c=this[a]|this[a+1]<<8;return c&32768?c|4294901760:c};a.prototype.readInt16BE=
function(a,b){b||d(a,2,this.length);var c=this[a+1]|this[a]<<8;return c&32768?c|4294901760:c};a.prototype.readInt32LE=function(a,b){b||d(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};a.prototype.readInt32BE=function(a,b){b||d(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};a.prototype.readFloatLE=function(a,b){b||d(a,4,this.length);return y.read(this,a,!0,23,4)};a.prototype.readFloatBE=function(a,b){b||d(a,4,this.length);return y.read(this,a,!1,
23,4)};a.prototype.readDoubleLE=function(a,b){b||d(a,8,this.length);return y.read(this,a,!0,52,8)};a.prototype.readDoubleBE=function(a,b){b||d(a,8,this.length);return y.read(this,a,!1,52,8)};a.prototype.writeUInt8=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,1,255,0);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));this[e]=b;return e+1};a.prototype.writeUInt16LE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[e]=b,this[e+1]=b>>>8):f(this,b,e,!0);return e+2};a.prototype.writeUInt16BE=
function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[e]=b>>>8,this[e+1]=b):f(this,b,e,!1);return e+2};a.prototype.writeUInt32LE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[e+3]=b>>>24,this[e+2]=b>>>16,this[e+1]=b>>>8,this[e]=b):g(this,b,e,!0);return e+4};a.prototype.writeUInt32BE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[e]=b>>>24,this[e+1]=b>>>16,this[e+2]=b>>>8,this[e+3]=b):g(this,b,
e,!1);return e+4};a.prototype.writeInt8=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,1,127,-128);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));0>b&&(b=255+b+1);this[e]=b;return e+1};a.prototype.writeInt16LE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[e]=b,this[e+1]=b>>>8):f(this,b,e,!0);return e+2};a.prototype.writeInt16BE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[e]=b>>>8,this[e+1]=b):f(this,b,e,!1);return e+2};a.prototype.writeInt32LE=
function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,4,2147483647,-2147483648);a.TYPED_ARRAY_SUPPORT?(this[e]=b,this[e+1]=b>>>8,this[e+2]=b>>>16,this[e+3]=b>>>24):g(this,b,e,!0);return e+4};a.prototype.writeInt32BE=function(b,e,d){b=+b;e>>>=0;d||c(this,b,e,4,2147483647,-2147483648);0>b&&(b=4294967295+b+1);a.TYPED_ARRAY_SUPPORT?(this[e]=b>>>24,this[e+1]=b>>>16,this[e+2]=b>>>8,this[e+3]=b):g(this,b,e,!1);return e+4};a.prototype.writeFloatLE=function(a,b,c){return k(this,a,b,!0,c)};a.prototype.writeFloatBE=function(a,
b,c){return k(this,a,b,!1,c)};a.prototype.writeDoubleLE=function(a,b,c){return e(this,a,b,!0,c)};a.prototype.writeDoubleBE=function(a,b,c){return e(this,a,b,!1,c)};a.prototype.copy=function(b,c,e,d){e||(e=0);d||0===d||(d=this.length);c||(c=0);if(d!==e&&0!==b.length&&0!==this.length){if(d<e)throw new TypeError("sourceEnd < sourceStart");if(0>c||c>=b.length)throw new TypeError("targetStart out of bounds");if(0>e||e>=this.length)throw new TypeError("sourceStart out of bounds");if(0>d||d>this.length)throw new TypeError("sourceEnd out of bounds");
d>this.length&&(d=this.length);b.length-c<d-e&&(d=b.length-c+e);d-=e;if(1E3>d||!a.TYPED_ARRAY_SUPPORT)for(var f=0;f<d;f++)b[f+c]=this[f+e];else b._set(this.subarray(e,e+d),c)}};a.prototype.fill=function(a,b,c){a||(a=0);b||(b=0);c||(c=this.length);if(c<b)throw new TypeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new TypeError("start out of bounds");if(0>c||c>this.length)throw new TypeError("end out of bounds");if("number"===typeof a)for(;b<c;b++)this[b]=a;else{a=u(a.toString());
for(var e=a.length;b<c;b++)this[b]=a[b%e]}return this}};a.prototype.toArrayBuffer=function(){if("undefined"!==typeof Uint8Array){if(a.TYPED_ARRAY_SUPPORT)return(new a(this)).buffer;for(var b=new Uint8Array(this.length),c=0,e=b.length;c<e;c+=1)b[c]=this[c];return b.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};var r=a.prototype;a._augment=function(b){b.constructor=a;b._isBuffer=!0;b._get=b.get;b._set=b.set;b.get=r.get;b.set=r.set;b.write=r.write;b.toString=r.toString;
b.toLocaleString=r.toString;b.toJSON=r.toJSON;b.equals=r.equals;b.compare=r.compare;b.copy=r.copy;b.slice=r.slice;b.readUInt8=r.readUInt8;b.readUInt16LE=r.readUInt16LE;b.readUInt16BE=r.readUInt16BE;b.readUInt32LE=r.readUInt32LE;b.readUInt32BE=r.readUInt32BE;b.readInt8=r.readInt8;b.readInt16LE=r.readInt16LE;b.readInt16BE=r.readInt16BE;b.readInt32LE=r.readInt32LE;b.readInt32BE=r.readInt32BE;b.readFloatLE=r.readFloatLE;b.readFloatBE=r.readFloatBE;b.readDoubleLE=r.readDoubleLE;b.readDoubleBE=r.readDoubleBE;
b.writeUInt8=r.writeUInt8;b.writeUInt16LE=r.writeUInt16LE;b.writeUInt16BE=r.writeUInt16BE;b.writeUInt32LE=r.writeUInt32LE;b.writeUInt32BE=r.writeUInt32BE;b.writeInt8=r.writeInt8;b.writeInt16LE=r.writeInt16LE;b.writeInt16BE=r.writeInt16BE;b.writeInt32LE=r.writeInt32LE;b.writeInt32BE=r.writeInt32BE;b.writeFloatLE=r.writeFloatLE;b.writeFloatBE=r.writeFloatBE;b.writeDoubleLE=r.writeDoubleLE;b.writeDoubleBE=r.writeDoubleBE;b.fill=r.fill;b.inspect=r.inspect;b.toArrayBuffer=r.toArrayBuffer;return b};var t=
/[^+\/0-9A-z]/g},{"base64-js":21,ieee754:24,"is-array":26}],23:[function(h,p,l){function a(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function b(a){return"function"===typeof a}function d(a){return"object"===typeof a&&null!==a}p.exports=a;a.EventEmitter=a;a.prototype._events=void 0;a.prototype._maxListeners=void 0;a.defaultMaxListeners=10;a.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||isNaN(a))throw TypeError("n must be a positive number");this._maxListeners=
a;return this};a.prototype.emit=function(a){var f,g,m,k;this._events||(this._events={});if("error"===a&&(!this._events.error||d(this._events.error)&&!this._events.error.length)){f=arguments[1];if(f instanceof Error)throw f;throw TypeError('Uncaught, unspecified "error" event.');}g=this._events[a];if(void 0===g)return!1;if(b(g))switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:f=arguments.length;m=Array(f-
1);for(k=1;k<f;k++)m[k-1]=arguments[k];g.apply(this,m)}else if(d(g)){f=arguments.length;m=Array(f-1);for(k=1;k<f;k++)m[k-1]=arguments[k];g=g.slice();f=g.length;for(k=0;k<f;k++)g[k].apply(this,m)}return!0};a.prototype.addListener=function(c,f){var g;if(!b(f))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",c,b(f.listener)?f.listener:f);this._events[c]?d(this._events[c])?this._events[c].push(f):this._events[c]=[this._events[c],
f]:this._events[c]=f;d(this._events[c])&&!this._events[c].warned&&(g=void 0!==this._maxListeners?this._maxListeners:a.defaultMaxListeners)&&0<g&&this._events[c].length>g&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),"function"===typeof console.trace&&console.trace());return this};a.prototype.on=a.prototype.addListener;a.prototype.once=function(a,d){function g(){this.removeListener(a,
g);m||(m=!0,d.apply(this,arguments))}if(!b(d))throw TypeError("listener must be a function");var m=!1;g.listener=d;this.on(a,g);return this};a.prototype.removeListener=function(a,f){var g,m,k;if(!b(f))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;g=this._events[a];k=g.length;m=-1;if(g===f||b(g.listener)&&g.listener===f)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,f);else if(d(g)){for(;0<k--;)if(g[k]===f||g[k].listener&&
g[k].listener===f){m=k;break}if(0>m)return this;1===g.length?(g.length=0,delete this._events[a]):g.splice(m,1);this._events.removeListener&&this.emit("removeListener",a,f)}return this};a.prototype.removeAllListeners=function(a){var d;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(d in this._events)"removeListener"!==d&&this.removeAllListeners(d);this.removeAllListeners("removeListener");
this._events={};return this}d=this._events[a];if(b(d))this.removeListener(a,d);else for(;d.length;)this.removeListener(a,d[d.length-1]);delete this._events[a];return this};a.prototype.listeners=function(a){return this._events&&this._events[a]?b(this._events[a])?[this._events[a]]:this._events[a].slice():[]};a.listenerCount=function(a,d){return a._events&&a._events[d]?b(a._events[d])?1:a._events[d].length:0}},{}],24:[function(h,p,l){l.read=function(a,b,d,c,f){var g;g=8*f-c-1;var m=(1<<g)-1,k=m>>1,e=
-7;f=d?f-1:0;var h=d?-1:1,n=a[b+f];f+=h;d=n&(1<<-e)-1;n>>=-e;for(e+=g;0<e;d=256*d+a[b+f],f+=h,e-=8);g=d&(1<<-e)-1;d>>=-e;for(e+=c;0<e;g=256*g+a[b+f],f+=h,e-=8);if(0===d)d=1-k;else{if(d===m)return g?NaN:Infinity*(n?-1:1);g+=Math.pow(2,c);d-=k}return(n?-1:1)*g*Math.pow(2,d-c)};l.write=function(a,b,d,c,f,g){var m,k=8*g-f-1,e=(1<<k)-1,h=e>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;g=c?0:g-1;var l=c?1:-1,z=0>b||0===b&&0>1/b?1:0;b=Math.abs(b);isNaN(b)||Infinity===b?(b=isNaN(b)?1:0,c=e):(c=Math.floor(Math.log(b)/
Math.LN2),1>b*(m=Math.pow(2,-c))&&(c--,m*=2),b=1<=c+h?b+n/m:b+n*Math.pow(2,1-h),2<=b*m&&(c++,m/=2),c+h>=e?(b=0,c=e):1<=c+h?(b=(b*m-1)*Math.pow(2,f),c+=h):(b=b*Math.pow(2,h-1)*Math.pow(2,f),c=0));for(;8<=f;a[d+g]=b&255,g+=l,b/=256,f-=8);c=c<<f|b;for(k+=f;0<k;a[d+g]=c&255,g+=l,c/=256,k-=8);a[d+g-l]|=128*z}},{}],25:[function(h,p,l){p.exports="function"===typeof Object.create?function(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:
function(a,b){a.super_=b;var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a}},{}],26:[function(h,p,l){var a=Object.prototype.toString;p.exports=Array.isArray||function(b){return!!b&&"[object Array]"==a.call(b)}},{}],27:[function(h,p,l){p.exports.RTCIceCandidate=h("./rtcicecandidate");p.exports.RTCPeerConnection=h("./rtcpeerconnection");p.exports.RTCSessionDescription=h("./rtcsessiondescription")},{"./rtcicecandidate":30,"./rtcpeerconnection":31,"./rtcsessiondescription":33}],
28:[function(h,p,l){function a(b,d,c,f,g,m,k,e,h,n){if(!(this instanceof a))return new a(b,d,c,f,g,m,k,e,h,n);var l=!1;b=b||"0.0.0.0";k="number"===typeof k?k:9;e="boolean"===typeof e?e:!0;h=h||null;n=n||null;Object.defineProperties(this,{_address:{get:function(){return b},set:function(a){b=a}},_candidates:{value:[]},_port:{get:function(){return k},set:function(a){k=a}},_rejected:{get:function(){return l},set:function(a){l=a}},_streamId:{get:function(){return h},set:function(a){h=a}},_track:{get:function(){return n},
set:function(a){n=a}},_triples:{value:new Set},candidates:{enumerable:!0,get:function(){return this._candidates.slice()}},capabilities:{enumerable:!0,value:c},defaultCandidate:{enumerable:!0,get:function(){return this._candidates.length?this._candidates[0]:null}},direction:{enumerable:!0,value:f},kind:{enumerable:!0,value:g},port:{enumerable:!0,get:function(){return k}},rtcpMux:{enumerable:!0,value:e},streamId:{enumerable:!0,get:function(){return h}},track:{enumerable:!0,get:function(){return n}}});
d&&d.forEach(this.addCandidate,this)}a.prototype.addCandidate=function(a){var d=[a.ip,a.port,a.protocol].join(" ");return this._triples.has(d)?!1:(this._triples.add(d),this._candidates.push(a),!0)};a.prototype.copy=function(b,d,c,f,g,h,k){return new a(this.address,d,c||this.capabilities,f||this.direction,this.kind,this.mid,g,this.rtcpMux,h,k)};a.prototype.copyAndReject=function(){return(new a(null,this.candidates,this.capabilities,this.direction,this.kind,this.mid,null,this.rtcpMux)).reject()};a.prototype.reject=
function(){this.setPort(0);return this};a.prototype.setAddress=function(a){this._address=a;return this};a.prototype.setPort=function(a){this._port=a;return this};p.exports=a},{}],29:[function(h,p,l){function a(b,d){if(!(this instanceof a))return new a(b,d);Event.call(this,b,d);Object.defineProperties(this,{stream:{enumerable:!0,value:d.stream}})}p.exports=a},{}],30:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);Object.defineProperties(this,{candidate:{enumerable:!0,value:b.candidate},
sdpMLineIndex:{enumerable:!0,value:b.sdpMLineIndex}})}p.exports=a},{}],31:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);b={gatherPolicy:b.gatherPolicy||"all",iceServers:[]};var e=new RTCIceGatherer(b),c=!1;e.onlocalcandidate=this._onlocalcandidate.bind(this);var d=null,f=!1,g=0,k=new RTCIceTransport,h=null;k.onicestatechange=this._onicestatechange.bind(this);var m=new RTCDtlsTransport(k);m.ondtlsstatechange=this._ondtlsstatechange.bind(this);var l="stable",u=null,p=null,B=
null,F=null;Object.defineProperties(this,{_dtlsTransport:{value:m},_dtmfSenders:{value:new Map},_gatherOptions:{value:b},_iceCandidatesAdded:{get:function(){return g},set:function(a){g=a}},_iceGatherer:{value:e},_iceGatheringCompleted:{get:function(){return c},set:function(a){c=a}},_iceTransport:{value:k},_localCandidates:{value:new Set},_localDescription:{get:function(){return p},set:function(a){p=a}},_localStreams:{value:[]},_midCounters:{value:{audio:0,video:0}},_remoteCandidates:{value:new Set},
_remoteDescription:{get:function(){return B},set:function(a){B=a}},_remoteStreams:{value:[]},_rtpReceivers:{value:new Map},_rtpSenders:{value:new Map},_signalingState:{get:function(){return l},set:function(a){l=a;if(this.onsignalingstatechange)this.onsignalingstatechange()}},_streamIds:{value:new Map},iceConnectionState:{enumerable:!0,get:function(){return k.state}},iceGatheringState:{enumerable:!0,get:function(){return c?"gathering":"complete"}},localDescription:{enumerable:!0,get:function(){return p}},
onaddstream:{enumerable:!0,get:function(){return F},set:function(a){F=a}},onicecandidate:{enumerable:!0,get:function(){return d},set:function(a){d=a;if(!f)try{e.getLocalCandidates().forEach(e.onlocalcandidate)}catch(b){}f=!0}},oniceconnectionstatechange:{enumerable:!0,get:function(){return h},set:function(a){h=a}},onsignalingstatechange:{enumerable:!0,get:function(){return u},set:function(a){u=a}},remoteDescription:{enumerable:!0,get:function(){return B}},signalingState:{enumerable:!0,get:function(){return l}}})}
function b(a){return Error("Invalid signaling state: "+a)}function d(a,b){var e=[];a.forEach(function(a){b.forEach(function(b){a.name===b.name&&a.clockRate===b.clockRate&&a.numChannels===b.numChannels&&e.push(b)})});return e}var c=h("./mediasection"),f=h("./mediastreamevent"),g=h("./rtcicecandidate"),m=h("./rtcpeerconnectioniceevent"),k=h("./rtcsessiondescription"),e=h("sdp-transform"),u=h("./sdp-utils");a.prototype._makeMid=function(a){return a+ ++this._midCounters[a]};a.prototype._ondtlsstatechange=
function(a){void 0};a.prototype._onicestatechange=function(a){if(this.oniceconnectionstatechange)this.oniceconnectionstatechange(a)};a.prototype._onlocalcandidate=function(a){Object.keys(a.candidate).length||(this._iceGatheringCompleted=!0);this._localCandidates.add(a.candidate);if(this.onicecandidate){a=a.candidate;if(Object.keys(a).length){var b=["a=candidate",a.foundation,1,a.protocol,a.priority,a.ip,a.port,a.type];a.relatedAddress&&(b=b.concat(["raddr",a.relatedAddress,"rport",a.relatedPort]));
b.push("generation 0");a=new g({candidate:b.join(" "),sdpMLineIndex:0})}else a=null;this.onicecandidate(new m("icecandidate",{candidate:a}))}};a.prototype._sendRtp=function(a){var b=a.kind;this._rtpSenders.forEach(function(e){e.track.kind===b&&e.send(a.capabilities)},this);return this};a.prototype._sendAndReceiveRtp=function(a){a.forEach(function(a){"sendrecv"!==a.direction&&"sendonly"!==a.direction||this._sendRtp(a);"sendrecv"!==a.direction&&"recvonly"!==a.direction||this._receiveRtp(a)},this);return this};
a.prototype._receiveRtp=function(a){var b=new RTCRtpReceiver(this._dtlsTransport,a.capabilities.type);b.receive(a.capabilities);a=b.track;this._rtpReceivers.set(a,b);b=new MediaStream;b.addTrack(a);this._remoteStreams.push(b);if(this.onaddstream)this.onaddstream(new f("addstream",{stream:b}));return this};a.prototype._startDtlsTransport=function(a){this._dtlsTransport.start(a);return this};a.prototype._startIceTransport=function(a){this._iceTransport.start(this._iceGatherer,a,"have-local-offer"===
this.signalingState?"controlling":"controlled");return this};a.prototype.addIceCandidate=function(a,b,e){void 0;this._iceCandidatesAdded++;a?(e=a.candidate.indexOf("candidate:"),a=a.candidate.slice(e+10).replace(/ +/g," ").split(" "),e={foundation:a[0],protocol:a[2],priority:parseInt(a[3]),ip:a[4],port:parseInt(a[5]),type:a[7],relatedAddress:null,relatedPort:0,tcpType:"active"},"host"!==e.type&&(e.relatedAddress=a[9],e.relatedPort=parseInt(a[11])),a=e):a={};e=[a.ip,a.port,a.transport].join(" ");this._remoteCandidates.has(e)||
(this._remoteCandidates.add(e),this._iceTransport.addRemoteCandidate(a));b&&b()};a.prototype.addStream=function(a){this._localStreams.push(a);a.getTracks().forEach(function(b){var e=new RTCRtpSender(b,this._dtlsTransport);this._rtpSenders.set(b,e);this._streamIds.set(b,a.id)},this)};a.prototype.close=function(){this._signalingState="closed";this._rtpReceivers.forEach(function(a){a.stop()});this._dtlsTransport.stop();this._iceTransport.stop()};a.prototype.createAnswer=function(a,c){if("have-remote-offer"!==
this.signalingState)return void c(b(this.signalingState));var f=u.parseDescription(this.remoteDescription),g={audio:[],video:[]};this.getLocalStreams().forEach(function(a){g.audio=g.audio.concat(a.getAudioTracks());g.video=g.video.concat(a.getVideoTracks())});f=f.mediaSections.map(function(a){var b=a.kind,e=a.direction,c=a.capabilities,f=RTCRtpSender.getCapabilities(b),f=d(c.codecs,f.codecs),c={codecs:f},k;if(!f.length)return a.copyAndReject();"inactive"===e||"recvonly"===e&&!g[b].length?b="inactive":
"recvonly"===e?(k=g[b].shift(),b="sendonly"):b="sendrecv"===e?(k=g[b].shift())?"sendrecv":"recvonly":"recvonly";e=this._streamIds.get(k);return a.copy(null,null,c,b,null,e,k)},this);f.forEach(function(a){this._localCandidates.forEach(a.addCandidate,a)},this);var h=u.makeInitialSDPBlob();u.addMediaSectionsToSDPBlob(h,f);u.addIceParametersToSDPBlob(h,this._iceGatherer.getLocalParameters());u.addDtlsParametersToSDPBlob(h,this._dtlsTransport.getLocalParameters());f=new k({sdp:e.write(h),type:"answer"});
a(f)};a.prototype.createDTMFSender=function(a){if(!this._dtmfSenders.has(a)){var b=this._rtpSenders.get(a),b=new RTCDtmfSender(b);this._dtmfSenders.set(a,b)}return this._dtmfSenders.get(a)};a.prototype.createOffer=function(a,b,d){var f={audio:null,video:null},g={audio:0,video:0};d=d||{};["optional","mandatory"].forEach(function(a){a in d&&("OfferToReceiveAudio"in d[a]&&(f.audio=Number(d[a].OfferToReceiveAudio)),"OfferToReceiveVideo"in d[a]&&(f.video=Number(d[a].OfferToReceiveVideo)))});var h=[],m=
{audio:f.audio,video:f.video};this.getLocalStreams().forEach(function(a){var b=a.getAudioTracks(),e=a.getVideoTracks();g.audio+=b.length;g.video+=e.length;b.concat(e).forEach(function(b){var e=b.kind,d=RTCRtpSender.getCapabilities(e),f,g=this._makeMid(e);null===m.audio?f="sendrecv":m[e]?(m[e]--,f="sendrecv"):f="sendonly";b=new c(null,null,d,f,e,g,null,null,a.id,b);h.push(b)},this)},this);["audio","video"].forEach(function(a){var b=Math.max(f[a]-g[a],0);if(b)for(var e=RTCRtpSender.getCapabilities(a),
d;b--;)d=this._makeMid(a),d=new c(null,null,e,"recvonly",a,d),h.push(d)},this);h.forEach(function(a){this._localCandidates.forEach(a.addCandidate,a)},this);b=u.makeInitialSDPBlob();u.addMediaSectionsToSDPBlob(b,h);u.addIceParametersToSDPBlob(b,this._iceGatherer.getLocalParameters());u.addDtlsParametersToSDPBlob(b,this._dtlsTransport.getLocalParameters());b=new k({sdp:e.write(b),type:"offer"});a(b)};a.prototype.getLocalStreams=function(){return this._localStreams.slice()};a.prototype.getRemoteStreams=
function(){return this._remoteStreams.slice()};a.prototype.setLocalDescription=function(a,e,c){switch(this.signalingState){case "stable":c="have-local-offer";break;case "have-remote-offer":c="stable";break;default:return void c(b(this.signalingState))}var d=u.parseDescription(a);if("have-remote-offer"===this.signalingState){d.mediaSections.forEach(this._sendRtp,this);var f=u.parseDescription(this.remoteDescription).mediaSections[0].capabilities.encodings[0].ssrc;d.mediaSections.forEach(function(a){a.capabilities.encodings.forEach(function(a){a.ssrc=
f});a.capabilities.rtcp.ssrc=f});d.mediaSections.forEach(this._receiveRtp,this)}this._localDescription=a;this._signalingState=c;e()};a.prototype.setRemoteDescription=function(a,e,c){switch(this.signalingState){case "stable":c="have-remote-offer";break;case "have-local-offer":c="stable";break;default:return void c(b(this.signalingState))}var d=u.parseDescription(a);d.mediaSections.forEach(function(a){a.candidates.forEach(this._iceTransport.addRemoteCandidate,this._iceTransport)},this);this._startIceTransport(d.iceParameters[0]);
this._startDtlsTransport(d.dtlsParameters[0]);"have-local-offer"===this.signalingState&&(d.mediaSections.forEach(this._receiveRtp,this),d.mediaSections.forEach(this._sendRtp,this));this._remoteDescription=a;this._signalingState=c;e()};p.exports=a},{"./mediasection":28,"./mediastreamevent":29,"./rtcicecandidate":30,"./rtcpeerconnectioniceevent":32,"./rtcsessiondescription":33,"./sdp-utils":34,"sdp-transform":37}],32:[function(h,p,l){function a(b,d){if(!(this instanceof a))return new a(b,d);Event.call(this,
b,d);Object.defineProperties(this,{candidate:{enumerable:!0,value:d.candidate}})}p.exports=a},{}],33:[function(h,p,l){function a(b){if(!(this instanceof a))return new a(b);Object.defineProperties(this,{sdp:{enumerable:!0,value:b.sdp},type:{enumerable:!0,value:b.type}})}p.exports=a},{}],34:[function(h,p,l){function a(a,b,c){a=a||{};a.candidates=a.candidates||[];if(!b)return a;b.forEach(function(b){if(b.foundation){var d={foundation:b.foundation,transport:b.protocol,priority:b.priority,ip:b.ip,port:b.port,
type:b.type,generation:0};b.relatedAddress&&(d.raddr=b.relatedAddress,d.rport=b.relatedPort);if("number"===typeof c)d.component=c,a.candidates.push(d);else{d.component=1;a.candidates.push(d);b={};for(var f in d)b[f]=d[f];b.component=2;a.candidates.push(b)}}else a.endOfCandidates="end-of-candidates"});return a}function b(b,c,d){b=b||{};if(!b.media)return b;b.media.forEach(function(b){a(b,c,d)});return b}function d(a,b){a=a||{};if(!a.media)return a;a.media.forEach(function(a){a=a||{};var c=b.fingerprints;
c.length&&(a.fingerprint={type:c[0].algorithm,hash:c[0].value})});return a}function c(a,b){a=a||{};if(!a.media)return a;a.media.forEach(function(a){a=a||{};a.iceUfrag=b.usernameFragment;a.icePwd=b.password});return a}function f(b,c){var d=c.streamId;d&&(b.msidSemantic=b.msidSemantic||{semantic:"WMS",token:[]},b.msidSemantic.token.push(d));var f=c.mid;if(f){b.groups=b.groups||[];var k=!1;b.groups.forEach(function(a){"BUNDLE"===a.type&&(a.mids.push(f),k=!0)});k||b.groups.push({type:"BUNDLE",mids:[f]})}var h=
[],m=[],l=[];c.capabilities.codecs.forEach(function(a){var b=a.preferredPayloadType;h.push(b);var c={payload:b,codec:a.name,rate:a.clockRate};1<a.numChannels&&(c.encoding=a.numChannels);m.push(c);switch(a.name){case "telephone-event":a.parameters&&a.parameters.events&&l.push({payload:b,config:a.parameters.events})}});var p=[];if(d&&c.track)var d=Math.floor(4294967296*Math.random()),r=g(),t=c.track.id,p=p.concat([{id:d,attribute:"cname",value:r},{id:d,attribute:"msid",value:c.streamId+" "+t},{id:d,
attribute:"mslabel",value:t},{id:d,attribute:"label",value:t}]);d=c.defaultCandidate;p={rtp:m,fmtp:l,type:c.kind,port:d?d.port:9,payloads:h.join(" "),protocol:"RTP/SAVPF",direction:c.direction,connection:{version:4,ip:d?d.ip:"0.0.0.0"},rtcp:{port:d?d.port:9,netType:"IN",ipVer:4,address:d?d.ip:"0.0.0.0"},ssrcs:p};f&&(p.mid=f);c.rtcpMux&&(p.rtcpMux="rtcp-mux");a(p,c.candidates);b.media.push(p);return b}function g(){for(var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/".split(""),
b=16,c="";b--;)c+=a[Math.floor(Math.random()*a.length)];return c}var m=h("./mediasection"),k=h("sdp-transform");p.exports.addCandidatesToSDPBlob=function(a,c,d){a=a||{};b(a,c,d);return a};p.exports.addDtlsParametersToSDPBlob=function(a,b){a=a||{};d(a,b);return a};p.exports.addIceParametersToSDPBlob=function(a,b){a=a||{};c(a,b);return a};p.exports.addMediaSectionsToSDPBlob=function(a,b){b.forEach(f.bind(null,a));return a};p.exports.makeInitialSDPBlob=function(a){a=a||Math.floor(4294967296*Math.random());
return{version:0,origin:{username:"-",sessionId:a,sessionVersion:0,netType:"IN",ipVer:4,address:"127.0.0.1"},name:"-",timing:{start:0,stop:0},connection:{version:4,ip:"0.0.0.0"},media:[]}};p.exports.parseDescription=function(a){a=k.parse(a.sdp);var b=[],c=[],d=[],f=[],g=[a];a.media&&(g=g.concat(a.media));g.forEach(function(a){a.iceUfrag&&a.icePwd&&a.fingerprint&&(b.push({usernameFragment:a.iceUfrag,password:a.icePwd}),c.push({fingerprints:[{algorithm:a.fingerprint.type,value:a.fingerprint.hash}]}));
if(a.rtp&&"video"!==a.type){var e=a.connection?a.connection.ip:null,g=a.direction,k=a.type,h=a.mid,l=a.port||null,p="rtcp-mux"===a.rtcpMux,x,B,F;(a.ssrcs||[]).forEach(function(a){switch(a.attribute){case "cname":B=a.id;x=a.value;break;case "label":case "mslabel":B=a.id;break;case "msid":B=a.id,F=a.value.split(" ")[0]}});var G={type:k,muxId:h,codecs:a.rtp.map(function(a){var b={name:a.codec,payloadType:parseInt(a.payload),clockRate:parseInt(a.rate),numChannels:a.encoding||1,rtcpFeedback:[],parameters:{}};
switch(a.codec){case "telephone-event":b.parameters.events="0-16"}return b}),headerExtensions:[],encodings:a.rtp.map(function(a){return{ssrc:B,codecPayloadType:parseInt(a.payload),active:!0}}),rtcp:{ssrc:B,cname:x,mux:p}},E=new m(e,d,G,g,k,h,l,p,F);(a.candidates||[]).forEach(function(a){a={foundation:String(a.foundation),protocol:a.transport,priority:a.priority,ip:a.ip,port:a.port,type:a.type,relatedAddress:a.raddr,relatedPort:a.rport};d.push(a);E.addCandidate(a)});void 0;"end-of-candidates"===a.endOfCandidates&&
E.addCandidate({});f.push(E)}});return{iceParameters:b,dtlsParameters:c,mediaSections:f}}},{"./mediasection":28,"sdp-transform":37}],35:[function(h,p,l){function a(){}h=p.exports={};h.nextTick=function(){if("undefined"!==typeof window&&window.setImmediate)return function(a){return window.setImmediate(a)};if("undefined"!==typeof window&&window.postMessage&&window.addEventListener){var a=[];window.addEventListener("message",function(d){var c=d.source;c!==window&&null!==c||"process-tick"!==d.data||(d.stopPropagation(),
0<a.length&&a.shift()())},!0);return function(d){a.push(d);window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}();h.title="browser";h.browser=!0;h.env={};h.argv=[];h.on=a;h.addListener=a;h.once=a;h.off=a;h.removeListener=a;h.removeAllListeners=a;h.emit=a;h.binding=function(a){throw Error("process.binding is not supported");};h.cwd=function(){return"/"};h.chdir=function(a){throw Error("process.chdir is not supported");}},{}],36:[function(h,p,l){var a=p.exports={v:[{name:"version",
reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",
reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":a.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",
reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},
{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(a){return null!=a.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},
{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,
names:"foundation component transport priority ip port type raddr rport tcptype generation".split(" "),format:function(a){var d;d="candidate:%s %d %s %d %s %d typ %s"+(null!=a.raddr?" raddr %s rport %d":"%v%v");d+=null!=a.tcptype?" tcptype %s":"%v";null!=a.generation&&(d+=" generation %d");return d}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},
{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,
names:["sctpmapNumber","app","maxMessageSize"],format:function(a){return null!=a.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{push:"invalid",names:["value"]}]};Object.keys(a).forEach(function(b){a[b].forEach(function(a){a.reg||(a.reg=/(.*)/);a.format||(a.format="%s")})})},{}],37:[function(h,p,l){p=h("./parser");h=h("./writer");l.write=h;l.parse=p.parse;l.parseFmtpConfig=p.parseFmtpConfig;l.parsePayloads=p.parsePayloads;l.parseRemoteCandidates=p.parseRemoteCandidates},{"./parser":38,"./writer":39}],
38:[function(h,p,l){var a=function(a){return String(Number(a))===a?Number(a):a},b=h("./grammar"),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);l.parse=function(c){var g={},h=[],k=g;c.split(/(\r\n|\r|\n)/).filter(d).forEach(function(c){var d=c[0],f=c.slice(2);"m"===d&&(h.push({rtp:[],fmtp:[]}),k=h[h.length-1]);for(c=0;c<(b[d]||[]).length;c+=1){var g=b[d][c];if(g.reg.test(f)){d=g;c=k;g=f;f=d.name&&d.names;d.push&&!c[d.push]?c[d.push]=[]:f&&!c[d.name]&&(c[d.name]={});var f=d.push?{}:f?c[d.name]:c,g=
g.match(d.reg),l=f,p=d.names,y=d.name;if(y&&!p)l[y]=a(g[1]);else for(y=0;y<p.length;y+=1)null!=g[y+1]&&(l[p[y]]=a(g[y+1]));d.push&&c[d.push].push(f);break}}});g.media=h;return g};var c=function(b,c){var d=c.split(/=(.+)/,2);2===d.length&&(b[d[0]]=a(d[1]));return b};l.parseFmtpConfig=function(a){return a.split(/\;\s?/).reduce(c,{})};l.parsePayloads=function(a){return a.split(" ").map(Number)};l.parseRemoteCandidates=function(b){var c=[];b=b.split(" ").map(a);for(var d=0;d<b.length;d+=3)c.push({component:b[d],
ip:b[d+1],port:b[d+2]});return c}},{"./grammar":36}],39:[function(h,p,l){var a=h("./grammar"),b=/%[sdv%]/g,d=function(a){var c=1,d=arguments,f=d.length;return a.replace(b,function(a){if(c>=f)return a;var b=d[c];c+=1;switch(a){case "%%":return"%";case "%s":return String(b);case "%d":return Number(b);case "%v":return""}})},c=function(a,b,c){var f=b.format instanceof Function?b.format(b.push?c:c[b.name]):b.format;a=[a+"="+f];if(b.names)for(f=0;f<b.names.length;f+=1){var g=b.names[f];b.name?a.push(c[b.name][g]):
a.push(c[b.names[f]])}else a.push(c[b.name]);return d.apply(null,a)},f="vosiuepcbtrza".split(""),g=["i","c","b","a"];p.exports=function(b,d){d=d||{};null==b.version&&(b.version=0);null==b.name&&(b.name=" ");b.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var e=d.innerOrder||g,h=[];(d.outerOrder||f).forEach(function(d){a[d].forEach(function(a){a.name in b&&null!=b[a.name]?h.push(c(d,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){h.push(c(d,a,b))})})});b.media.forEach(function(b){h.push(c("m",
a.m[0],b));e.forEach(function(d){a[d].forEach(function(a){a.name in b&&null!=b[a.name]?h.push(c(d,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){h.push(c(d,a,b))})})})});return h.join("\r\n")+"\r\n"}},{"./grammar":36}],40:[function(h,p,l){(function(a,b){"object"===typeof l?p.exports=b():"function"===typeof define&&define.amd?define(b):a.printStackTrace=b()})(this,function(){function a(b){b=b||{guess:!0};var d=b.e||null,c=!!b.guess,f=b.mode||null;b=new a.implementation;d=b.run(d,
f);return c?b.guessAnonymousFunctions(d):d}a.implementation=function(){};a.implementation.prototype={run:function(a,d){a=a||this.createException();d=d||this.mode(a);return"other"===d?this.other(arguments.callee):this[d](a)},createException:function(){try{this.undef()}catch(a){return a}},mode:function(a){return"undefined"!==typeof window&&-1<window.navigator.userAgent.indexOf("PhantomJS")?"phantomjs":a.arguments&&a.stack?"chrome":a.stack&&a.sourceURL?"safari":a.stack&&a.number?"ie":a.stack&&a.fileName?
"firefox":a.message&&a["opera#sourceloc"]?!a.stacktrace||-1<a.message.indexOf("\n")&&a.message.split("\n").length>a.stacktrace.split("\n").length?"opera9":"opera10a":a.message&&a.stack&&a.stacktrace?0>a.stacktrace.indexOf("called from line")?"opera10b":"opera11":a.stack&&!a.fileName?"chrome":"other"},instrumentFunction:function(b,d,c){b=b||window;var f=b[d];b[d]=function(){c.call(this,a().slice(4));return b[d]._instrumented.apply(this,arguments)};b[d]._instrumented=f},deinstrumentFunction:function(a,
d){a[d].constructor===Function&&a[d]._instrumented&&a[d]._instrumented.constructor===Function&&(a[d]=a[d]._instrumented)},chrome:function(a){return(a.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,
"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(a){return a.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},opera11:function(a){var d=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;a=a.stacktrace.split("\n");for(var c=[],f=0,g=a.length;f<g;f+=2){var h=
d.exec(a[f]);if(h){var k=h[4]+":"+h[1]+":"+h[2],h=h[3]||"global code",h=h.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}");c.push(h+"@"+k+" -- "+a[f+1].replace(/^\s+/,""))}}return c},opera10b:function(a){var d=/^(.*)@(.+):(\d+)$/;a=a.stacktrace.split("\n");for(var c=[],f=0,g=a.length;f<g;f++){var h=d.exec(a[f]);h&&c.push((h[1]?h[1]+"()":"global code")+"@"+h[2]+":"+h[3])}return c},opera10a:function(a){var d=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;
a=a.stacktrace.split("\n");for(var c=[],f=0,g=a.length;f<g;f+=2){var h=d.exec(a[f]);h&&c.push((h[3]||"{anonymous}")+"()@"+h[2]+":"+h[1]+" -- "+a[f+1].replace(/^\s+/,""))}return c},opera9:function(a){var d=/Line (\d+).*script (?:in )?(\S+)/i;a=a.message.split("\n");for(var c=[],f=2,g=a.length;f<g;f+=2){var h=d.exec(a[f]);h&&c.push("{anonymous}()@"+h[2]+":"+h[1]+" -- "+a[f+1].replace(/^\s+/,""))}return c},phantomjs:function(a){var d=/(\S+) \((\S+)\)/i;a=a.stack.split("\n");for(var c=[],f=1,g=a.length;f<
g;f++){a[f]=a[f].replace(/^\s+at\s+/gm,"");var h=d.exec(a[f]);h?c.push(h[1]+"()@"+h[2]):c.push("{anonymous}()@"+a[f])}return c},other:function(a){for(var d=/function(?:\s+([\w$]+))?\s*\(/,c=[],f,g,h=Array.prototype.slice;a&&10>c.length;){f=d.test(a.toString())?RegExp.$1||"{anonymous}":"{anonymous}";try{g=h.call(a.arguments||[])}catch(k){g=["Cannot access arguments: "+k]}c[c.length]=f+"("+this.stringifyArguments(g)+")";try{a=a.caller}catch(k){c[c.length]="Cannot access caller: "+k;break}}return c},
stringifyArguments:function(a){for(var d=[],c=Array.prototype.slice,f=0;f<a.length;++f){var g=a[f];void 0===g?d[f]="undefined":null===g?d[f]="null":g.constructor&&(d[f]=g.constructor===Array?3>g.length?"["+this.stringifyArguments(g)+"]":"["+this.stringifyArguments(c.call(g,0,1))+"..."+this.stringifyArguments(c.call(g,-1))+"]":g.constructor===Object?"#object":g.constructor===Function?"#function":g.constructor===String?'"'+g+'"':g.constructor===Number?g:"?")}return d.join(",")},sourceCache:{},ajax:function(a){var d=
this.createXMLHTTPObject();if(d)try{return d.open("GET",a,!1),d.send(null),d.responseText}catch(c){}return""},createXMLHTTPObject:function(){for(var a,d=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<d.length;c++)try{return a=d[c](),this.createXMLHTTPObject=d[c],a}catch(f){}},isSameDomain:function(a){return"undefined"!==typeof location&&
-1!==a.indexOf(location.hostname)},getSource:function(a){a in this.sourceCache||(this.sourceCache[a]=this.ajax(a).split("\n"));return this.sourceCache[a]},guessAnonymousFunctions:function(a){for(var d=0;d<a.length;++d){var c=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,f=a[d],g=/\{anonymous\}\(.*\)@(.*)/.exec(f);if(g){var h=c.exec(g[1]);h&&(c=h[1],g=h[2],h=h[3]||0,c&&this.isSameDomain(c)&&g&&(c=this.guessAnonymousFunction(c,g,h),a[d]=f.replace("{anonymous}",c)))}}return a},guessAnonymousFunction:function(a,
d,c){var f;try{f=this.findFunctionName(this.getSource(a),d)}catch(g){f="getSource failed with url: "+a+", exception: "+g.toString()}return f},findFunctionName:function(a,d){for(var c=/function\s+([^(]*?)\s*\(([^)]*)\)/,f=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,g=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,h="",k,e=Math.min(d,20),l,n=0;n<e;++n)if(k=a[d-n-1],l=k.indexOf("//"),0<=l&&(k=k.substr(0,l)),k)if(h=k+h,(k=f.exec(h))&&k[1]||(k=c.exec(h))&&k[1]||
(k=g.exec(h))&&k[1])return k[1];return"(?)"}};return a})},{}],41:[function(h,p,l){p.exports=function(a){return a&&"object"===typeof a&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},{}],42:[function(h,p,l){(function(a,b){function d(a,b){var d={seen:[],stylize:f};3<=arguments.length&&(d.depth=arguments[2]);4<=arguments.length&&(d.colors=arguments[3]);x(b)?d.showHidden=b:b&&l._extend(d,b);w(d.showHidden)&&(d.showHidden=!1);w(d.depth)&&(d.depth=2);w(d.colors)&&
(d.colors=!1);w(d.customInspect)&&(d.customInspect=!0);d.colors&&(d.stylize=c);return m(d,a,d.depth)}function c(a,b){var c=d.styles[b];return c?"\u001b["+d.colors[c][0]+"m"+a+"\u001b["+d.colors[c][1]+"m":a}function f(a,b){return a}function g(a){var b={};a.forEach(function(a,c){b[a]=!0});return b}function m(a,b,c){if(a.customInspect&&b&&C(b.inspect)&&b.inspect!==l.inspect&&(!b.constructor||b.constructor.prototype!==b)){var d=b.inspect(c,a);D(d)||(d=m(a,d,c));return d}if(d=k(a,b))return d;var f=Object.keys(b),
h=g(f);a.showHidden&&(f=Object.getOwnPropertyNames(b));if(v(b)&&(0<=f.indexOf("message")||0<=f.indexOf("description")))return e(b);if(0===f.length){if(C(b))return a.stylize("[Function"+(b.name?": "+b.name:"")+"]","special");if(r(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(q(b))return a.stylize(Date.prototype.toString.call(b),"date");if(v(b))return e(b)}var d="",t=!1,w=["{","}"];z(b)&&(t=!0,w=["[","]"]);C(b)&&(d=" [Function"+(b.name?": "+b.name:"")+"]");r(b)&&(d=" "+RegExp.prototype.toString.call(b));
q(b)&&(d=" "+Date.prototype.toUTCString.call(b));v(b)&&(d=" "+e(b));if(0===f.length&&(!t||0==b.length))return w[0]+d+w[1];if(0>c)return r(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);f=t?p(a,b,c,h,f):f.map(function(d){return n(a,b,c,h,d,t)});a.seen.pop();return A(f,d,w)}function k(a,b){if(w(b))return a.stylize("undefined","undefined");if(D(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,
"string")}if(y(b))return a.stylize(""+b,"number");if(x(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function e(a){return"["+Error.prototype.toString.call(a)+"]"}function p(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)Object.prototype.hasOwnProperty.call(b,String(g))?f.push(n(a,b,c,d,String(g),!0)):f.push("");e.forEach(function(e){e.match(/^\d+$/)||f.push(n(a,b,c,d,e,!0))});return f}function n(a,b,c,d,e,f){var g,h;b=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]};
b.get?h=b.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):b.set&&(h=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(d,e)||(g="["+e+"]");h||(0>a.seen.indexOf(b.value)?(h=null===c?m(a,b.value,null):m(a,b.value,c-1),-1<h.indexOf("\n")&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special"));if(w(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+
e);g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function A(a,b,c){var d=0;return 60<a.reduce(function(a,b){d++;0<=b.indexOf("\n")&&d++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function z(a){return Array.isArray(a)}function x(a){return"boolean"===typeof a}
function y(a){return"number"===typeof a}function D(a){return"string"===typeof a}function w(a){return void 0===a}function r(a){return t(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function t(a){return"object"===typeof a&&null!==a}function q(a){return t(a)&&"[object Date]"===Object.prototype.toString.call(a)}function v(a){return t(a)&&("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function C(a){return"function"===typeof a}function B(a){return 10>a?"0"+a.toString(10):
a.toString(10)}function F(){var a=new Date,b=[B(a.getHours()),B(a.getMinutes()),B(a.getSeconds())].join(":");return[a.getDate(),I[a.getMonth()],b].join(" ")}var G=/%[sdj%]/g;l.format=function(a){if(!D(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(d(arguments[c]));return b.join(" ")}for(var c=1,e=arguments,f=e.length,b=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case "%s":return String(e[c++]);case "%d":return Number(e[c++]);case "%j":try{return JSON.stringify(e[c++])}catch(b){return"[Circular]"}default:return a}}),
g=e[c];c<f;g=e[++c])b=null!==g&&t(g)?b+(" "+d(g)):b+(" "+g);return b};l.deprecate=function(c,d){if(w(b.process))return function(){return l.deprecate(c,d).apply(this,arguments)};if(!0===a.noDeprecation)return c;var e=!1;return function(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d);e=!0}return c.apply(this,arguments)}};var E={},H;l.debuglog=function(b){w(H)&&(H=a.env.NODE_DEBUG||"");b=b.toUpperCase();if(!E[b])if((new RegExp("\\b"+b+"\\b","i")).test(H)){var c=
a.pid;E[b]=function(){var a=l.format.apply(l,arguments);console.error("%s %d: %s",b,c,a)}}else E[b]=function(){};return E[b]};l.inspect=d;d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};d.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};l.isArray=z;l.isBoolean=x;l.isNull=
function(a){return null===a};l.isNullOrUndefined=function(a){return null==a};l.isNumber=y;l.isString=D;l.isSymbol=function(a){return"symbol"===typeof a};l.isUndefined=w;l.isRegExp=r;l.isObject=t;l.isDate=q;l.isError=v;l.isFunction=C;l.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===typeof a||"undefined"===typeof a};l.isBuffer=h("./support/isBuffer");var I="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");l.log=function(){console.log("%s - %s",
F(),l.format.apply(l,arguments))};l.inherits=h("inherits");l._extend=function(a,b){if(!b||!t(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,h("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":41,_process:35,inherits:25}],43:[function(h,p,l){function a(a,c,f){return c?new b(a,c):new b(a)}h=function(){return this}();var b=h.WebSocket||h.MozWebSocket;p.exports=b?a:null;
b&&(a.prototype=b.prototype)},{}],44:[function(h,p,l){l.XMLHttpRequest=XMLHttpRequest},{}]},{},[1]);
